{"version":3,"names":["select","dispatch","pick","isPlainObject","setBlockAdminSettings","setBlockRendererSettings","getDefaultBlockSupports","editable","required","attachment","description","defaultValue","placeholder","logic","logicConditions","innerBlocks","numeric","choices","payments","points","correctAnswers","registerBlockType","name","settings","console","error","getBlockType","supports","attributes","type","default","nextBtnLabel","classnames","properties","url","theme","themeId","randomize","label","customHTML","layout","attachmentFocalPoint","x","y","attachmentFancyBorderRadius","attachmentBorderRadius","attachmentMaxWidth","addBlockTypes"],"sources":["@quillforms/blocks/src/api/registration.ts"],"sourcesContent":["/* eslint-disable no-console */\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { select, dispatch } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { pick, isPlainObject } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport { setBlockAdminSettings } from './set-block-admin-settings';\r\nimport { setBlockRendererSettings } from './set-block-renderer-settings';\r\nimport type { BlockTypeSettings, BlockSupportedFeatures } from '../types';\r\n\r\nexport const getDefaultBlockSupports = (): BlockSupportedFeatures => {\r\n\r\n\treturn {\r\n\t\teditable: true,\r\n\t\trequired: true,\r\n\t\tattachment: true,\r\n\t\tdescription: true,\r\n\t\tdefaultValue: false,\r\n\t\tplaceholder: false,\r\n\t\tlogic: true,\r\n\t\tlogicConditions: true,\r\n\t\tinnerBlocks: false,\r\n\t\tnumeric: false,\r\n\t\tchoices: false,\r\n\t\tpayments: false,\r\n\t\tpoints: false,\r\n\t\tcorrectAnswers: false\r\n\t};\r\n};\r\n\r\n/**\r\n * Registers a new block provided a unique name and an object defining its\r\n * behavior. Once registered, the block is made available as an option to any\r\n * editor interface where blocks are implemented.\r\n *\r\n * @param  name     Block name.\r\n * @param  settings Block settings.\r\n *\r\n * @return The block settings, if it has been successfully registered;\r\n * otherwise `undefined`.\r\n */\r\nexport const registerBlockType = (\r\n\tname: string,\r\n\tsettings: BlockTypeSettings\r\n): BlockTypeSettings | undefined => {\r\n\tif ( typeof name !== 'string' ) {\r\n\t\tconsole.error( 'Block names must be strings.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( select( 'quillForms/blocks' ).getBlockType( name ) ) {\r\n\t\tconsole.error( 'Block \"' + name + '\" is already registered.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tsettings.supports = {\r\n\t\t...getDefaultBlockSupports(),\r\n\t\t...settings.supports,\r\n\t};\r\n\r\n\tlet { attributes } = settings;\r\n\tconst { supports } = settings;\r\n\r\n\tif ( ! attributes || ! isPlainObject( attributes ) ) {\r\n\t\tattributes = {};\r\n\t}\r\n\tif ( supports.required ) {\r\n\t\tattributes.required = {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdefault: false,\r\n\t\t};\r\n\t}\r\n\r\n\tattributes.nextBtnLabel = {\r\n\t\ttype: [ 'string', 'boolean' ],\r\n\t\tdefault: false,\r\n\t};\r\n\r\n\tattributes.classnames = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\r\n\tif ( supports.placeholder ) {\r\n\t\tattributes.placeholder = {\r\n\t\t\ttype: [ 'string', 'boolean' ],\r\n\t\t\tdefault: false,\r\n\t\t};\r\n\t}\r\n\tif ( supports.attachment ) {\r\n\t\tattributes.attachment = {\r\n\t\t\ttype: 'object',\r\n\t\t\tproperties: {\r\n\t\t\t\turl: {\r\n\t\t\t\t\ttype: 'string',\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t};\r\n\t}\r\n\r\n\tif ( supports.defaultValue ) {\r\n\t\tattributes.defaultValue = {\r\n\t\t\ttype: 'string',\r\n\t\t\tdefault: '',\r\n\t\t};\r\n\t}\r\n\r\n\tif ( supports.description ) {\r\n\t\tattributes.description = {\r\n\t\t\ttype: 'string',\r\n\t\t\tdefault: '',\r\n\t\t};\r\n\t}\r\n\tif ( supports.theme ) {\r\n\t\tattributes.themeId = {\r\n\t\t\ttype: 'number',\r\n\t\t};\r\n\t}\r\n\r\n\tif ( name === 'dropdown' ||\r\n\t\t name === 'multiple-choice' ||\r\n\t\t name === 'picture-choice' \r\n\t) {\r\n\t\tattributes.randomize = {\r\n\t\t\ttype: 'boolean',\r\n\t\t\tdefault: false\r\n\t\t}\r\n\t}\r\n\tattributes.label = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\tattributes.customHTML = {\r\n\t\ttype: 'string',\r\n\t\tdefault: '',\r\n\t};\r\n\tattributes.layout = {\r\n\t\ttype: 'string',\r\n\t\tdefault: 'stack',\r\n\t};\r\n\tattributes.attachmentFocalPoint = {\r\n\t\ttype: 'object',\r\n\t\tdefault: {\r\n\t\t\tx: 0.5,\r\n\t\t\ty: 0.5,\r\n\t\t},\r\n\t};\r\n\r\n\tattributes.attachmentFancyBorderRadius = {\r\n\t\ttype: 'boolean',\r\n\t\tdefault: false,\r\n\t};\r\n\r\n\tattributes.attachmentBorderRadius = {\r\n\t\ttype: 'boolean',\r\n\t\tdefault: '0px',\r\n\t};\r\n\r\n\tattributes.attachmentMaxWidth = {\r\n\t\ttype: 'string',\r\n\t\tdefault: 'none',\r\n\t};\r\n\r\n\tsettings.attributes = attributes;\r\n\r\n\tdispatch( 'quillForms/blocks' ).addBlockTypes( {\r\n\t\tname,\r\n\t\t...pick( settings, [ 'attributes', 'supports', 'logicalOperators' ] ),\r\n\t} );\r\n\tsetBlockRendererSettings( name, settings );\r\n\tsetBlockAdminSettings( name, settings );\r\n\treturn settings;\r\n};\r\n\r\n/**\r\n * Returns a registered block type.\r\n *\r\n * @param {string} name Block name.\r\n *\r\n * @return {?BlockTypeSettingss} Block type.\r\n */\r\nexport function getBlockType( name: string ): BlockTypeSettings | undefined {\r\n\treturn select( 'quillForms/blocks' ).getBlockType( name );\r\n}\r\n"],"mappings":"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"}