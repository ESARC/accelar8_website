{"version":3,"names":["select","dispatch","isFunction","pick","setBlockRendererSettings","name","settings","display","console","error","blockType","getBlockType","mergeTag","counterIcon","nextBtn","isConditionFulfilled","conditionOperator","conditionVal","fieldValue","Array","isArray","includes","isNaN","parseFloat","indexOf","startsWith","endsWith","getNumericVal","val","_attributes"],"sources":["@quillforms/blocks/src/api/set-block-renderer-settings.ts"],"sourcesContent":["/* eslint no-console: [ 'error', { allow: [ 'error' ] } ] */\r\nimport { select, dispatch } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { isFunction, pick } from 'lodash';\r\n\r\nimport type { BlockRendererSettings } from '../types';\r\n/**\r\n * Set block renderer settings\r\n * Set block renderer settings is for defining renderer behavior for the block\r\n *\r\n * @param {string} name     Block name.\r\n * @param {Object} settings Block renderer settings.\r\n *\r\n */\r\nexport const setBlockRendererSettings = (\r\n\tname: string,\r\n\tsettings: BlockRendererSettings\r\n): BlockRendererSettings | undefined => {\r\n\tsettings = {\r\n\t\tdisplay: () => null,\r\n\t\t...settings,\r\n\t};\r\n\r\n\tif ( typeof name !== 'string' ) {\r\n\t\tconsole.error( 'Block types must be strings.' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst blockType = select( 'quillForms/blocks' ).getBlockType( name );\r\n\r\n\tif ( ! blockType ) {\r\n\t\tconsole.error(\r\n\t\t\t`The ${ name } block isn't registered. Please register it first!`\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( ! isFunction( settings.display ) ) {\r\n\t\tconsole.error( 'The \"display\" property must be a valid function!' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( settings.mergeTag && ! isFunction( settings.mergeTag ) ) {\r\n\t\tconsole.error( 'The \"mergeTag\" property must be a valid function!' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( settings.counterIcon && ! isFunction( settings.counterIcon ) ) {\r\n\t\tconsole.error( 'The \"counterIcon\" property must be a valid function!' );\r\n\t\treturn;\r\n\t}\r\n\r\n\tif ( settings.nextBtn && ! isFunction( settings.nextBtn ) ) {\r\n\t\tconsole.error( 'The \"nextBtn\" property must be a valid function!' );\r\n\t\treturn;\r\n\t}\r\n\tif (\r\n\t\tsettings.isConditionFulfilled &&\r\n\t\t! isFunction( settings.isConditionFulfilled )\r\n\t) {\r\n\t\tconsole.error(\r\n\t\t\t'The \"isConditionFulfilled\" property must be a valid function!'\r\n\t\t);\r\n\t\treturn;\r\n\t}\r\n\tif ( ! settings.isConditionFulfilled ) {\r\n\t\tsettings.isConditionFulfilled = (\r\n\t\t\tconditionOperator: string,\r\n\t\t\tconditionVal: any,\r\n\t\t\tfieldValue: any\r\n\t\t): boolean => {\r\n\t\t\tswitch ( conditionOperator ) {\r\n\t\t\t\tcase 'is': {\r\n\t\t\t\t\tif ( Array.isArray( fieldValue ) )\r\n\t\t\t\t\t\treturn fieldValue.includes( conditionVal );\r\n\r\n\t\t\t\t\treturn fieldValue == conditionVal;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'is_not': {\r\n\t\t\t\t\tif ( Array.isArray( fieldValue ) )\r\n\t\t\t\t\t\treturn ! fieldValue.includes( conditionVal );\r\n\r\n\t\t\t\t\treturn fieldValue != conditionVal;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'greater_than': {\r\n\t\t\t\t\tif ( isNaN( fieldValue ) || isNaN( conditionVal ) ) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\tparseFloat( fieldValue ) > parseFloat( conditionVal )\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'lower_than': {\r\n\t\t\t\t\tif ( isNaN( fieldValue ) || isNaN( conditionVal ) ) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\tparseFloat( fieldValue ) < parseFloat( conditionVal )\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'contains': {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttypeof fieldValue !== 'string' ||\r\n\t\t\t\t\t\ttypeof conditionVal !== 'string'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fieldValue.indexOf( conditionVal ) !== -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'not_contains': {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttypeof fieldValue !== 'string' ||\r\n\t\t\t\t\t\ttypeof conditionVal !== 'string'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fieldValue.indexOf( conditionVal ) === -1;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'starts_with': {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttypeof fieldValue !== 'string' ||\r\n\t\t\t\t\t\ttypeof conditionVal !== 'string'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fieldValue.startsWith( conditionVal );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcase 'ends_with': {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttypeof fieldValue !== 'string' ||\r\n\t\t\t\t\t\ttypeof conditionVal !== 'string'\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fieldValue.endsWith( conditionVal );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t};\r\n\t}\r\n\r\n\tif ( settings.getNumericVal && ! isFunction( settings.getNumericVal ) ) {\r\n\t\tconsole.error( 'The \"getNumericVal\" must be a function' );\r\n\t\treturn;\r\n\t}\r\n\tif ( ! settings.getNumericVal ) {\r\n\t\tsettings.getNumericVal = ( val, _attributes ) => {\r\n\t\t\treturn parseFloat( val );\r\n\t\t};\r\n\t}\r\n\tdispatch( 'quillForms/blocks' ).setBlockRendererSettings(\r\n\t\tpick( settings, [\r\n\t\t\t'display',\r\n\t\t\t'mergeTag',\r\n\t\t\t'nextBtn',\r\n\t\t\t'counterIcon',\r\n\t\t\t'isConditionFulfilled',\r\n\t\t\t'getNumericVal',\r\n\t\t\t'displayLayout',\r\n\t\t] ),\r\n\t\tname\r\n\t);\r\n\r\n\treturn settings;\r\n};\r\n"],"mappings":"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"}