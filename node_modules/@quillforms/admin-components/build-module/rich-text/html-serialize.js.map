{"version":3,"names":["removep","escapeHtml","Text","size","htmlSerialize","value","serialize","node","nodeText","text","isText","bold","italic","Array","isArray","map","subNode","serializeNode","join","children","n","type","url","data","modifier"],"sources":["@quillforms/admin-components/src/rich-text/html-serialize.ts"],"sourcesContent":["/**\r\n * WordPress Dependencies\r\n */\r\nimport { removep } from '@wordpress/autop';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport escapeHtml from 'escape-html';\r\nimport { Text, Node } from 'slate';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport type { CustomNode, MergeTag } from './types';\r\nimport { size } from 'lodash';\r\nconst htmlSerialize = ( value: Node ): string => {\r\n\treturn removep( serialize( value ) );\r\n};\r\nconst serialize = ( node: CustomNode ) => {\r\n\tlet nodeText = escapeHtml( node.text );\r\n\tif ( Text.isText( node ) ) {\r\n\t\tif ( node.bold ) {\r\n\t\t\tnodeText = `<strong>` + nodeText + `</strong>`;\r\n\t\t}\r\n\r\n\t\tif ( node.italic ) {\r\n\t\t\tnodeText = `<em>` + nodeText + `</em>`;\r\n\t\t}\r\n\r\n\t\tif ( nodeText === '' ) {\r\n\t\t\treturn '<br />';\r\n\t\t}\r\n\r\n\t\treturn nodeText;\r\n\t}\r\n\r\n\tif ( Array.isArray( node ) ) {\r\n\t\treturn node\r\n\t\t\t.map( ( subNode ) => {\r\n\t\t\t\treturn serializeNode( subNode );\r\n\t\t\t} )\r\n\t\t\t.join( '' );\r\n\t}\r\n\r\n\treturn serializeNode( node );\r\n};\r\n\r\nconst serializeNode = ( node: CustomNode ) => {\r\n\tconst children =\r\n\t\tsize( node.children ) > 0\r\n\t\t\t? node.children.map( ( n ) => serialize( n ) ).join( '' )\r\n\t\t\t: '';\r\n\tswitch ( node.type ) {\r\n\t\tcase 'link':\r\n\t\t\treturn `<a target=\"_blank\" href=\"${ escapeHtml(\r\n\t\t\t\tnode.url\r\n\t\t\t) }\">${ children }</a>`;\r\n\t\tcase 'mergeTag':\r\n\t\t\treturn `{{${ ( node.data as MergeTag ).type }:${\r\n\t\t\t\t( node.data as MergeTag ).modifier\r\n\t\t\t}}}`;\r\n\t\tcase 'paragraph':\r\n\t\t\treturn `<p>${ children }</p>`;\r\n\t\tdefault:\r\n\t\t\treturn `${ children }`;\r\n\t}\r\n};\r\n\r\nexport default htmlSerialize;\r\n"],"mappings":"AAAA;AACA;AACA;AACA,SAASA,OAAO,QAAQ,kBAAkB;;AAE1C;AACA;AACA;AACA,OAAOC,UAAU,MAAM,aAAa;AACpC,SAASC,IAAI,QAAc,OAAO;;AAElC;AACA;AACA;;AAEA,SAASC,IAAI,QAAQ,QAAQ;AAC7B,MAAMC,aAAa,GAAKC,KAAW,IAAc;EAChD,OAAOL,OAAO,CAAEM,SAAS,CAAED,KAAK,CAAE,CAAE;AACrC,CAAC;AACD,MAAMC,SAAS,GAAKC,IAAgB,IAAM;EACzC,IAAIC,QAAQ,GAAGP,UAAU,CAAEM,IAAI,CAACE,IAAI,CAAE;EACtC,IAAKP,IAAI,CAACQ,MAAM,CAAEH,IAAI,CAAE,EAAG;IAC1B,IAAKA,IAAI,CAACI,IAAI,EAAG;MAChBH,QAAQ,GAAI,UAAS,GAAGA,QAAQ,GAAI,WAAU;IAC/C;IAEA,IAAKD,IAAI,CAACK,MAAM,EAAG;MAClBJ,QAAQ,GAAI,MAAK,GAAGA,QAAQ,GAAI,OAAM;IACvC;IAEA,IAAKA,QAAQ,KAAK,EAAE,EAAG;MACtB,OAAO,QAAQ;IAChB;IAEA,OAAOA,QAAQ;EAChB;EAEA,IAAKK,KAAK,CAACC,OAAO,CAAEP,IAAI,CAAE,EAAG;IAC5B,OAAOA,IAAI,CACTQ,GAAG,CAAIC,OAAO,IAAM;MACpB,OAAOC,aAAa,CAAED,OAAO,CAAE;IAChC,CAAC,CAAE,CACFE,IAAI,CAAE,EAAE,CAAE;EACb;EAEA,OAAOD,aAAa,CAAEV,IAAI,CAAE;AAC7B,CAAC;AAED,MAAMU,aAAa,GAAKV,IAAgB,IAAM;EAC7C,MAAMY,QAAQ,GACbhB,IAAI,CAAEI,IAAI,CAACY,QAAQ,CAAE,GAAG,CAAC,GACtBZ,IAAI,CAACY,QAAQ,CAACJ,GAAG,CAAIK,CAAC,IAAMd,SAAS,CAAEc,CAAC,CAAE,CAAE,CAACF,IAAI,CAAE,EAAE,CAAE,GACvD,EAAE;EACN,QAASX,IAAI,CAACc,IAAI;IACjB,KAAK,MAAM;MACV,OAAQ,4BAA4BpB,UAAU,CAC7CM,IAAI,CAACe,GAAG,CACN,KAAKH,QAAU,MAAK;IACxB,KAAK,UAAU;MACd,OAAQ,KAAOZ,IAAI,CAACgB,IAAI,CAAeF,IAAM,IAC1Cd,IAAI,CAACgB,IAAI,CAAeC,QAC1B,IAAG;IACL,KAAK,WAAW;MACf,OAAQ,MAAML,QAAU,MAAK;IAC9B;MACC,OAAQ,GAAGA,QAAU,EAAC;EAAC;AAE1B,CAAC;AAED,eAAef,aAAa"}