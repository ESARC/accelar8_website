{"version":3,"names":["useRef","useEffect","forwardRef","createPortal","cx","css","useSlate","useFocused","Editor","Range","Link","FormatButton","FormatBoldIcon","FormatItalicIcon","Menu","_ref","ref","className","props","createElement","_extends","HoveringToolbar","_ref2","toggleFormat","isFormatActive","formattingControls","editor","inFocus","el","current","selection","isCollapsed","string","removeAttribute","domSelection","window","getSelection","domRange","getRangeAt","rect","getBoundingClientRect","style","opacity","top","pageYOffset","offsetHeight","left","pageXOffset","offsetWidth","width","includes","format","document","body"],"sources":["@quillforms/admin-components/src/rich-text/components/hovering-toolbar/index.tsx"],"sourcesContent":["/**\r\n * WordPress Dependencies\r\n */\r\nimport { useRef, useEffect, forwardRef } from 'react';\r\nimport { createPortal } from 'react-dom';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { cx, css } from 'emotion';\r\nimport { useSlate, useFocused } from 'slate-react';\r\nimport { Editor, Range } from 'slate';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport Link from '../link';\r\nimport FormatButton from '../format-button';\r\nimport FormatBoldIcon from './bold-icon';\r\nimport FormatItalicIcon from './italic-icon';\r\ninterface Props {\r\n\tclassName: string;\r\n\t[ key: string ]: unknown;\r\n}\r\n\r\nconst Menu = forwardRef< HTMLDivElement, React.PropsWithChildren< Props > >(\r\n\t( { className, ...props }, ref ) => (\r\n\t\t<div\r\n\t\t\t{ ...props }\r\n\t\t\tref={ ref }\r\n\t\t\tclassName={ cx(\r\n\t\t\t\tclassName,\r\n\t\t\t\tcss`\r\n\t\t\t\t\t& > * {\r\n\t\t\t\t\t\tdisplay: inline-block;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t& > * + * {\r\n\t\t\t\t\t\tmargin-left: 15px;\r\n\t\t\t\t\t}\r\n\t\t\t\t`\r\n\t\t\t) }\r\n\t\t/>\r\n\t)\r\n);\r\n\r\nconst HoveringToolbar = ( {\r\n\ttoggleFormat,\r\n\tisFormatActive,\r\n\tformattingControls,\r\n} ) => {\r\n\tconst ref = useRef< HTMLDivElement | null >( null );\r\n\tconst editor = useSlate();\r\n\tconst inFocus = useFocused();\r\n\tuseEffect( () => {\r\n\t\tconst el = ref.current;\r\n\t\tconst { selection } = editor;\r\n\r\n\t\tif ( ! el ) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (\r\n\t\t\t! selection ||\r\n\t\t\t! inFocus ||\r\n\t\t\tRange.isCollapsed( selection ) ||\r\n\t\t\tEditor.string( editor, selection ) === ''\r\n\t\t) {\r\n\t\t\tel.removeAttribute( 'style' );\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst domSelection = window.getSelection();\r\n\t\tconst domRange = domSelection?.getRangeAt( 0 );\r\n\t\tconst rect = domRange?.getBoundingClientRect();\r\n\t\tel.style.opacity = '1';\r\n\t\tif ( rect ) {\r\n\t\t\tel.style.top = `${\r\n\t\t\t\trect.top + window.pageYOffset - el.offsetHeight\r\n\t\t\t}px`;\r\n\t\t\tel.style.left = `${\r\n\t\t\t\trect.left +\r\n\t\t\t\twindow.pageXOffset -\r\n\t\t\t\tel.offsetWidth / 2 +\r\n\t\t\t\trect.width / 2\r\n\t\t\t}px`;\r\n\t\t}\r\n\t} );\r\n\r\n\treturn createPortal(\r\n\t\t<Menu\r\n\t\t\tref={ ref }\r\n\t\t\tclassName={ css`\r\n\t\t\t\tpadding: 8px 7px 6px;\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tz-index: 1;\r\n\t\t\t\ttop: -10000px;\r\n\t\t\t\tleft: -10000px;\r\n\t\t\t\tmargin-top: -6px;\r\n\t\t\t\topacity: 0;\r\n\t\t\t\tbackground-color: #222;\r\n\t\t\t\tborder-radius: 4px;\r\n\t\t\t\ttransition: opacity 0.75s;\r\n\r\n\t\t\t\tsvg {\r\n\t\t\t\t\twidth: 20px;\r\n\t\t\t\t}\r\n\t\t\t` }\r\n\t\t>\r\n\t\t\t{ !! formattingControls && formattingControls.includes( 'bold' ) && (\r\n\t\t\t\t<FormatButton\r\n\t\t\t\t\tformat=\"bold\"\r\n\t\t\t\t\ttoggleFormat={ () => toggleFormat( 'bold' ) }\r\n\t\t\t\t\tisFormatActive={ () => isFormatActive( 'bold' ) }\r\n\t\t\t\t>\r\n\t\t\t\t\t<FormatBoldIcon />\r\n\t\t\t\t</FormatButton>\r\n\t\t\t) }\r\n\t\t\t{ !! formattingControls &&\r\n\t\t\t\tformattingControls.includes( 'italic' ) && (\r\n\t\t\t\t\t<FormatButton\r\n\t\t\t\t\t\tformat=\"italic\"\r\n\t\t\t\t\t\ttoggleFormat={ () => toggleFormat( 'italic' ) }\r\n\t\t\t\t\t\tisFormatActive={ () => isFormatActive( 'italic' ) }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<FormatItalicIcon />\r\n\t\t\t\t\t</FormatButton>\r\n\t\t\t\t) }\r\n\t\t\t{ !! formattingControls &&\r\n\t\t\t\tformattingControls.includes( 'link' ) && (\r\n\t\t\t\t\t<Link editor={ editor } />\r\n\t\t\t\t) }\r\n\t\t</Menu>,\r\n\t\tdocument.body\r\n\t);\r\n};\r\nexport default HoveringToolbar;\r\n"],"mappings":"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"}