{"version":3,"names":["useSelect","classnames","Icon","check","chevronDown","__","sprintf","useCallback","render","Button","VisuallyHidden","itemToString","item","name","span","document","createElement","tmp","appendChild","children","innerText","undefined","stateReducer","_ref","_ref2","selectedItem","type","changes","props","items","stateChangeTypes","ToggleButtonKeyDownArrowDown","Math","min","indexOf","length","ToggleButtonKeyDownArrowUp","max","SelectControl","_ref3","__next36pxDefaultSize","className","hideLabelFromVision","label","describedBy","options","onChange","onSelectedItemChange","value","_selectedItem","getLabelProps","getToggleButtonProps","getMenuProps","getItemProps","isOpen","highlightedIndex","initialSelectedItem","getDescribedBy","menuProps","onKeyDownHandler","e","stopPropagation","onKeyDown","startsWith","_extends","as","icon","size","map","index","key","__experimentalHint","style"],"sources":["@quillforms/admin-components/src/select-control/index.tsx"],"sourcesContent":["// Forked from @WordPress/components and added a feature of supporting item labels as React components.\r\n/**\r\n * External dependencies\r\n */\r\nimport { useSelect } from 'downshift';\r\nimport classnames from 'classnames';\r\n\r\n/**\r\n * WordPress dependencies\r\n */\r\nimport { Icon, check, chevronDown } from '@wordpress/icons';\r\nimport { __, sprintf } from '@wordpress/i18n';\r\nimport { useCallback } from 'react';\r\nimport { render } from 'react-dom';\r\n\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tButton,\r\n\tVisuallyHidden,\r\n} from '@wordpress/components';\r\n\r\nconst itemToString = ( item ) => {\r\n\tif ( item?.name ) {\r\n\t\tif ( typeof item.name === 'string' ) {\r\n\t\t\treturn item.name;\r\n\t\t}\r\n\t\tconst span = document.createElement( 'span' );\r\n\t\trender( item.name, span );\r\n\t\tconst tmp = document.createElement( 'div' );\r\n\t\ttmp.appendChild( span );\r\n\t\t// @ts-expect-error\r\n\t\treturn tmp.children[ 0 ]?.innerText;\r\n\t\t// var div = document.createElement( 'div' );\r\n\t\t// div.innerHTML = reactToHtmlString;\r\n\t\t// return div.textContent || div.innerText || '';\r\n\t}\r\n\treturn undefined;\r\n};\r\n// This is needed so that in Windows, where\r\n// the menu does not necessarily open on\r\n// key up/down, you can still switch between\r\n// options with the menu closed.\r\nconst stateReducer = (\r\n\t{ selectedItem },\r\n\t{ type, changes, props: { items } }\r\n) => {\r\n\tswitch ( type ) {\r\n\t\tcase useSelect.stateChangeTypes.ToggleButtonKeyDownArrowDown:\r\n\t\t\t// If we already have a selected item, try to select the next one,\r\n\t\t\t// without circular navigation. Otherwise, select the first item.\r\n\t\t\treturn {\r\n\t\t\t\tselectedItem:\r\n\t\t\t\t\titems[\r\n\t\t\t\t\t\tselectedItem\r\n\t\t\t\t\t\t\t? Math.min(\r\n\t\t\t\t\t\t\t\t\titems.indexOf( selectedItem ) + 1,\r\n\t\t\t\t\t\t\t\t\titems.length - 1\r\n\t\t\t\t\t\t\t  )\r\n\t\t\t\t\t\t\t: 0\r\n\t\t\t\t\t],\r\n\t\t\t};\r\n\t\tcase useSelect.stateChangeTypes.ToggleButtonKeyDownArrowUp:\r\n\t\t\t// If we already have a selected item, try to select the previous one,\r\n\t\t\t// without circular navigation. Otherwise, select the last item.\r\n\t\t\treturn {\r\n\t\t\t\tselectedItem:\r\n\t\t\t\t\titems[\r\n\t\t\t\t\t\tselectedItem\r\n\t\t\t\t\t\t\t? Math.max( items.indexOf( selectedItem ) - 1, 0 )\r\n\t\t\t\t\t\t\t: items.length - 1\r\n\t\t\t\t\t],\r\n\t\t\t};\r\n\t\tdefault:\r\n\t\t\treturn changes;\r\n\t}\r\n};\r\n\r\ninterface Props {\r\n\tclassName?: string;\r\n\tlabel?: string;\r\n\toptions?: object;\r\n\tonChange: (item: any) => void;\r\n\tvalue: any;\r\n}\r\nconst SelectControl:React.FC<Props> = ( {\r\n\t/** Start opting into the larger default height that will become the default size in a future version. */\r\n\t// @ts-expect-error\r\n\t__next36pxDefaultSize = false,\r\n\tclassName,\r\n\t// @ts-expect-error\r\n\thideLabelFromVision,\r\n\tlabel,\r\n\t// @ts-expect-error\r\n\tdescribedBy,\r\n\toptions: items,\r\n\tonChange: onSelectedItemChange,\r\n\tvalue: _selectedItem,\r\n} ) => {\r\n\tconst {\r\n\t\tgetLabelProps,\r\n\t\tgetToggleButtonProps,\r\n\t\tgetMenuProps,\r\n\t\tgetItemProps,\r\n\t\tisOpen,\r\n\t\thighlightedIndex,\r\n\t\tselectedItem,\r\n\t} = useSelect( {\r\n\t\t// @ts-expect-error\r\n\t\tinitialSelectedItem: items[ 0 ],\r\n\t\t// @ts-expect-error\r\n\t\titems,\r\n\t\titemToString,\r\n\t\tonSelectedItemChange,\r\n\t\t...( typeof _selectedItem !== 'undefined' && _selectedItem !== null\r\n\t\t\t? { selectedItem: _selectedItem }\r\n\t\t\t: undefined ),\r\n\r\n\t\t// @ts-ignore\r\n\t\tstateReducer,\r\n\t} );\r\n\r\n\tfunction getDescribedBy() {\r\n\t\tif ( describedBy ) {\r\n\t\t\treturn describedBy;\r\n\t\t}\r\n\r\n\t\tif ( ! selectedItem ) {\r\n\t\t\treturn __( 'No selection' );\r\n\t\t}\r\n\r\n\t\t// translators: %s: The selected option.\r\n\t\treturn sprintf( __( 'Currently selected: %s' ), selectedItem.name );\r\n\t}\r\n\r\n\tconst menuProps = getMenuProps( {\r\n\t\tclassName: 'components-custom-select-control__menu',\r\n\t\t'aria-hidden': ! isOpen,\r\n\t} );\r\n\r\n\tconst onKeyDownHandler = useCallback(\r\n\t\t( e ) => {\r\n\t\t\te.stopPropagation();\r\n\t\t\tmenuProps?.onKeyDown?.( e );\r\n\t\t},\r\n\t\t[ menuProps ]\r\n\t);\r\n\r\n\t// We need this here, because the null active descendant is not fully ARIA compliant.\r\n\tif (\r\n\t\tmenuProps[ 'aria-activedescendant' ]?.startsWith( 'downshift-null' )\r\n\t) {\r\n\t\tdelete menuProps[ 'aria-activedescendant' ];\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"admin-components-select-control\">\r\n\t\t\t<div\r\n\t\t\t\tclassName={ classnames(\r\n\t\t\t\t\t'components-custom-select-control',\r\n\t\t\t\t\tclassName\r\n\t\t\t\t) }\r\n\t\t\t>\r\n\t\t\t\t{ hideLabelFromVision ? (\r\n\t\t\t\t\t<VisuallyHidden as=\"label\" { ...getLabelProps() }>\r\n\t\t\t\t\t\t{ label }\r\n\t\t\t\t\t</VisuallyHidden>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t/* eslint-disable-next-line jsx-a11y/label-has-associated-control, jsx-a11y/label-has-for */\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\t{ ...getLabelProps( {\r\n\t\t\t\t\t\t\tclassName:\r\n\t\t\t\t\t\t\t\t'components-custom-select-control__label',\r\n\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{ label }\r\n\t\t\t\t\t</label>\r\n\t\t\t\t) }\r\n\t\t\t\t<Button\r\n\t\t\t\t\t{ ...getToggleButtonProps( {\r\n\t\t\t\t\t\t// This is needed because some speech recognition software don't support `aria-labelledby`.\r\n\t\t\t\t\t\t'aria-label': label,\r\n\t\t\t\t\t\t'aria-labelledby': undefined,\r\n\t\t\t\t\t\tclassName: classnames(\r\n\t\t\t\t\t\t\t'components-custom-select-control__button',\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t'is-next-36px-default-size':\r\n\t\t\t\t\t\t\t\t\t__next36pxDefaultSize,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t),\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\tdescribedBy: getDescribedBy(),\r\n\t\t\t\t\t} ) }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ selectedItem?.name }\r\n\t\t\t\t\t<Icon\r\n\t\t\t\t\t\ticon={ chevronDown }\r\n\t\t\t\t\t\tclassName={ classnames(\r\n\t\t\t\t\t\t\t'components-custom-select-control__button-icon',\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t'is-next-36px-default-size':\r\n\t\t\t\t\t\t\t\t\t__next36pxDefaultSize,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\tsize={ 18 }\r\n\t\t\t\t\t/>\r\n\t\t\t\t</Button>\r\n\t\t\t\t{ /* eslint-disable-next-line jsx-a11y/no-noninteractive-element-interactions */ }\r\n\t\t\t\t<ul { ...menuProps } onKeyDown={ onKeyDownHandler }>\r\n\t\t\t\t\t{ isOpen &&\r\n\t\t\t\t\t    // @ts-expect-error\r\n\t\t\t\t\t\titems.map( ( item, index ) => {\r\n\t\t\t\t\t\t\t//console.log( item );\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t// eslint-disable-next-line react/jsx-key\r\n\t\t\t\t\t\t\t\t<li\r\n\t\t\t\t\t\t\t\t\t{ ...getItemProps( {\r\n\t\t\t\t\t\t\t\t\t\titem,\r\n\t\t\t\t\t\t\t\t\t\tindex,\r\n\t\t\t\t\t\t\t\t\t\tkey: item.key,\r\n\t\t\t\t\t\t\t\t\t\tclassName: classnames(\r\n\t\t\t\t\t\t\t\t\t\t\titem.className,\r\n\t\t\t\t\t\t\t\t\t\t\t'components-custom-select-control__item',\r\n\t\t\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t\t\t'is-highlighted':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex === highlightedIndex,\r\n\t\t\t\t\t\t\t\t\t\t\t\t'has-hint':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t!! item.__experimentalHint,\r\n\t\t\t\t\t\t\t\t\t\t\t\t'is-next-36px-default-size':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t__next36pxDefaultSize,\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t),\r\n\t\t\t\t\t\t\t\t\t\tstyle: item.style,\r\n\t\t\t\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{ item.name }\r\n\t\t\t\t\t\t\t\t\t{ item.__experimentalHint && (\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"components-custom-select-control__item-hint\">\r\n\t\t\t\t\t\t\t\t\t\t\t{ item.__experimentalHint }\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t{ item === selectedItem && (\r\n\t\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\t\ticon={ check }\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"components-custom-select-control__item-icon\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} ) }\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\nexport default SelectControl;\r\n"],"mappings":"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"}