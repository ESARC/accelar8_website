{"version":3,"names":["sanitizeBlockAttributes","memo","useState","useEffect","Icon","blockDefault","plus","useSelect","useDispatch","classNames","css","tinycolor","areEqual","prevProps","nextProps","disabled","BlockTypesListItem","_ref","blockName","index","disableAnimation","destinationIndex","parent","isMounted","setIsMounted","setTimeout","blockType","select","getBlockType","icon","src","renderedIcon","createElement","insertEmptyFieldAnswer","__experimentalInsertBlock","setCurrentBlock","generateBlockId","Math","random","toString","substr","createBlock","name","attributes","arguments","length","undefined","id","onClick","e","stopPropagation","blockToInsert","supports","editable","document","querySelector","getElementById","scrollIntoView","behavior","className","color","setAlpha","mounted","style","backgroundColor","title"],"sources":["@quillforms/admin-components/src/block-types-list-item/index.tsx"],"sourcesContent":["/* eslint-disable jsx-a11y/no-static-element-interactions */\r\n/* eslint-disable jsx-a11y/click-events-have-key-events */\r\n/**\r\n * QuillForms Dependencies\r\n */\r\nimport type {\r\n\tIconDescriptor,\r\n\tFormBlock,\r\n\tIcon as IconType,\r\n} from '@quillforms/types';\r\nimport { sanitizeBlockAttributes } from '@quillforms/blocks';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { memo, useState, useEffect } from 'react';\r\n// @ts-expect-error\r\nimport { Icon, Dashicon } from '@wordpress/components';\r\nimport { blockDefault, plus } from '@wordpress/icons';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { FC } from 'react';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport classNames from 'classnames';\r\nimport { css } from 'emotion';\r\nimport tinycolor from 'tinycolor2';\r\n\r\nconst areEqual = (prevProps: Props, nextProps: Props): boolean => {\r\n\tif (prevProps.disabled === nextProps.disabled) return true;\r\n\treturn false;\r\n};\r\ninterface Props {\r\n\tdisabled: boolean;\r\n\tblockName: string;\r\n\tindex: number;\r\n\tdisableAnimation?: boolean;\r\n\tdestinationIndex: number;\r\n\tparent?: string;\r\n}\r\nconst BlockTypesListItem: FC<Props> = memo(\r\n\t({\r\n\t\tdisabled,\r\n\t\tblockName,\r\n\t\tindex,\r\n\t\tdisableAnimation,\r\n\t\tdestinationIndex,\r\n\t\tparent,\r\n\t}) => {\r\n\t\tconst [isMounted, setIsMounted] = useState(false);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetIsMounted(true);\r\n\t\t\t}, 50);\r\n\t\t}, []);\r\n\t\tconst { blockType } = useSelect((select) => {\r\n\t\t\treturn {\r\n\t\t\t\tblockType:\r\n\t\t\t\t\tselect('quillForms/blocks').getBlockType(blockName),\r\n\t\t\t};\r\n\t\t});\r\n\r\n\t\tif (!blockType) return null;\r\n\t\tlet { icon } = blockType;\r\n\t\tif ((icon as IconDescriptor)?.src === 'block-default') {\r\n\t\t\ticon = {\r\n\t\t\t\tsrc: blockDefault,\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (!icon) icon = plus;\r\n\t\tconst renderedIcon = (\r\n\t\t\t<Icon\r\n\t\t\t\ticon={\r\n\t\t\t\t\t((icon as IconDescriptor).src as IconType)\r\n\t\t\t\t\t\t? ((icon as IconDescriptor).src as IconType)\r\n\t\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t\t: (icon as Dashicon.Icon)\r\n\t\t\t\t}\r\n\t\t\t/>\r\n\t\t);\r\n\t\tconst { insertEmptyFieldAnswer } = useDispatch(\r\n\t\t\t'quillForms/renderer-core'\r\n\t\t);\r\n\t\tconst { __experimentalInsertBlock, setCurrentBlock } = useDispatch(\r\n\t\t\t'quillForms/block-editor'\r\n\t\t);\r\n\t\tconst generateBlockId = (): string => {\r\n\t\t\treturn Math.random().toString(36).substr(2, 9);\r\n\t\t};\r\n\r\n\t\t/**\r\n\t\t * Returns a block object given its type and attributes.\r\n\t\t *\r\n\t\t * @param {string} name       Block name.\r\n\t\t * @param {Object} attributes Block attributes.\r\n\t\t *\r\n\t\t * @throws {Error} If the block type isn't registered.\r\n\t\t * @return {Object?} Block object.\r\n\t\t */\r\n\t\tconst createBlock = (\r\n\t\t\tname: string,\r\n\t\t\tattributes: Record<string, unknown> = {}\r\n\t\t): FormBlock | void => {\r\n\t\t\t// Blocks are stored with a unique ID, the assigned type name, the block\r\n\t\t\t// attributes.\r\n\t\t\treturn {\r\n\t\t\t\tid: generateBlockId(),\r\n\t\t\t\tname,\r\n\t\t\t\tattributes: sanitizeBlockAttributes(name, attributes),\r\n\t\t\t};\r\n\t\t};\r\n\r\n\t\treturn (\r\n\t\t\t<div\r\n\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\tif (disabled) return;\r\n\t\t\t\t\te.stopPropagation();\r\n\t\t\t\t\tconst blockToInsert = createBlock(blockName);\r\n\t\t\t\t\tif (blockToInsert) {\r\n\t\t\t\t\t\t// blockToInsert.id = generateBlockId();\r\n\t\t\t\t\t\tif (blockType.supports.editable)\r\n\t\t\t\t\t\t\tinsertEmptyFieldAnswer(\r\n\t\t\t\t\t\t\t\tblockToInsert.id,\r\n\t\t\t\t\t\t\t\tblockName\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t__experimentalInsertBlock(\r\n\t\t\t\t\t\t\tblockToInsert,\r\n\t\t\t\t\t\t\tdestinationIndex,\r\n\t\t\t\t\t\t\tparent\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t!document.querySelector(\r\n\t\t\t\t\t\t\t\t\t`#block-editor-box-wrapper-${blockToInsert.id} .block-editor-block-edit`\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tsetCurrentBlock(blockToInsert.id);\r\n\t\t\t\t\t\t\t\tdocument\r\n\t\t\t\t\t\t\t\t\t?.getElementById(\r\n\t\t\t\t\t\t\t\t\t\t`block-editor-box-wrapper-${blockToInsert.id}`\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t?.scrollIntoView({ behavior: 'smooth' });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}, 80);\r\n\t\t\t\t\t}\r\n\t\t\t\t}}\r\n\t\t\t\tclassName={classNames(\r\n\t\t\t\t\t'admin-components-blocks-list-item',\r\n\t\t\t\t\tcss`\r\n\t\t\t\t\t\t&:not( .animation-disabled ) {\r\n\t\t\t\t\t\t\topacity: 0;\r\n\t\t\t\t\t\t\ttransform: translateX( -15px );\r\n\t\t\t\t\t\t\ttransition: transform 0.3s ease ${index * 0.1}s,\r\n\t\t\t\t\t\t\t\topacity 0.3s ease ${index * 0.1}s;\r\n\r\n\t\t\t\t\t\t\t&.mounted {\r\n\t\t\t\t\t\t\t\topacity: 1;\r\n\t\t\t\t\t\t\t\ttransform: scale( 1 );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t&:hover {\r\n\t\t\t\t\t\t\tbackground: ${tinycolor(blockType?.color)\r\n\t\t\t\t\t\t\t.setAlpha(0.1)\r\n\t\t\t\t\t\t\t.toString()};\r\n\t\t\t\t\t\t\tcursor: pointer;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t`,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdisabled: disabled ? true : false,\r\n\t\t\t\t\t\tmounted: isMounted,\r\n\t\t\t\t\t\t'animation-disabled': disableAnimation,\r\n\t\t\t\t\t}\r\n\t\t\t\t)}\r\n\t\t\t>\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName=\"admin-components-blocks-list-item__icon-wrapper\"\r\n\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\tbackgroundColor: blockType?.color\r\n\t\t\t\t\t\t\t? blockType.color\r\n\t\t\t\t\t\t\t: '#bb426f',\r\n\t\t\t\t\t}}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"admin-components-blocks-list-item__icon\">\r\n\t\t\t\t\t\t{renderedIcon}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</span>\r\n\t\t\t\t<span className=\"admin-components-blocks-list-item__block-name\">\r\n\t\t\t\t\t{blockType?.title}\r\n\t\t\t\t</span>\r\n\t\t\t\t{(blockType?.name === 'group' || blockType?.name === 'slider') && (\r\n\t\t\t\t\t<div className=\"admin-components-control-label__new-feature\">\r\n\t\t\t\t\t\tNEW\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t);\r\n\t},\r\n\tareEqual\r\n);\r\n\r\nexport default BlockTypesListItem;\r\n"],"mappings":"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"}