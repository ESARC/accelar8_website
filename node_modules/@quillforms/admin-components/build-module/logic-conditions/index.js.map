{"version":3,"names":["useSelect","useEffect","Icon","closeSmall","forEach","size","ComboboxControl","OperatorSelector","TextControl","Button","LogicConditions","_ref","value","onChange","combobox","formBlocks","blockTypes","select","getBlocks","getBlockTypes","blocks","block","name","supports","editable","push","innerBlocks","childBlock","Array","isArray","length","vars","customize","override","handler","customizable","sections","options","filter","section","includes","key","option","type","_option$other$name","blockType","other","logic","logicConditions","customized","createElement","className","map","group","gi","icon","onClick","$value","splice","condition","ci","_combobox$excerptLeng","var0Type","var0Value","op","var1Value","find","$block","id","operators","logicalOperators","row1","row2","excerptLength","var0","isToggleEnabled","hideChooseOption","selectFirstOption","logicControl","attributes","setValue","var1","removeCondition","isPrimary"],"sources":["@quillforms/admin-components/src/logic-conditions/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport {\r\n\tEditorLogicCondition,\r\n\tFormBlocks,\r\n\tLogicConditionOperator,\r\n} from '@quillforms/types';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useEffect } from 'react';\r\nimport { Icon } from '@wordpress/components';\r\nimport { closeSmall } from '@wordpress/icons';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { forEach, size } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport ComboboxControl, {\r\n\tCustomizeFunction,\r\n\tCustomizeObject,\r\n} from '../combobox-control';\r\nimport OperatorSelector from './operator-selector';\r\nimport TextControl from '../text-control';\r\nimport Button from '../button';\r\n\r\nexport type LogicConditionsProps = {\r\n\tvalue: EditorLogicCondition[][];\r\n\tonChange: ( value: EditorLogicCondition[][] ) => void;\r\n\tcombobox?: {\r\n\t\tcustomize?: {\r\n\t\t\thandler: CustomizeFunction;\r\n\t\t\toverride?: boolean;\r\n\t\t};\r\n\t\texcerptLength?: number;\r\n\t};\r\n};\r\n\r\nconst LogicConditions: React.FC< LogicConditionsProps > = ( {\r\n\tvalue,\r\n\tonChange,\r\n\tcombobox,\r\n} ) => {\r\n\tconst { formBlocks, blockTypes } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\t// @ts-ignore\r\n\t\t\tformBlocks: select( 'quillForms/block-editor' ).getBlocks(),\r\n\t\t\tblockTypes: select( 'quillForms/blocks' ).getBlockTypes(),\r\n\t\t};\r\n\t} );\r\n\r\n\tconst blocks: FormBlocks = [];\r\n\r\n\tif ( size( formBlocks ) > 0 ) {\r\n\t\tforEach( formBlocks, ( block ) => {\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.editable ) {\r\n\t\t\t\tblocks.push( { ...block } );\r\n\t\t\t}\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.innerBlocks ) {\r\n\t\t\t\tif ( size( block?.innerBlocks ) > 0 ) {\r\n\t\t\t\t\tforEach( block.innerBlocks, ( childBlock ) => {\r\n\t\t\t\t\t\tblocks.push( {\r\n\t\t\t\t\t\t\t...childBlock,\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\t// update value on mount if input isn't array or is empty array.\r\n\tuseEffect( () => {\r\n\t\tif ( ! Array.isArray( value ) || value.length === 0 ) {\r\n\t\t\tonChange( [ [ { vars: [ {}, {} ] } ] ] );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tconst customize = combobox?.customize?.override\r\n\t\t? combobox.customize.handler\r\n\t\t: ( customizable: CustomizeObject ) => {\r\n\t\t\t\tlet { sections, options } = customizable;\r\n\t\t\t\tsections = sections.filter( ( section ) =>\r\n\t\t\t\t\t[ 'fields', 'variables', 'hidden_fields' ].includes(\r\n\t\t\t\t\t\tsection.key\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\toptions = options.filter( ( option ) => {\r\n\t\t\t\t\tif ( option.type === 'field' ) {\r\n\t\t\t\t\t\tconst blockType =\r\n\t\t\t\t\t\t\tblockTypes[ option.other?.name ?? '' ];\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\tblockType?.supports?.logic &&\r\n\t\t\t\t\t\t\tblockType?.supports?.logicConditions\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t[ 'variable', 'hidden_field' ].includes( option.type )\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif ( combobox?.customize ) {\r\n\t\t\t\t\tconst customized = combobox.customize.handler( {\r\n\t\t\t\t\t\tsections,\r\n\t\t\t\t\t\toptions,\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tsections = customized.sections;\r\n\t\t\t\t\toptions = customized.options;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn { sections, options };\r\n\t\t  };\r\n\r\n\tif ( ! Array.isArray( value ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"logic-conditions\">\r\n\t\t\t{ value.map( ( group, gi ) => (\r\n\t\t\t\t<div key={ gi }>\r\n\t\t\t\t\t<div className=\"logic-conditions__group\">\r\n\t\t\t\t\t\t{ value.length > 1 && (\r\n\t\t\t\t\t\t\t<div className=\"group-remove\">\r\n\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\ticon={ closeSmall }\r\n\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t$value.splice( gi, 1 );\r\n\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t{ group.map( ( condition, ci ) => {\r\n\t\t\t\t\t\t\tconst var0Type = condition.vars[ 0 ].type;\r\n\t\t\t\t\t\t\tconst var0Value = condition.vars[ 0 ].value;\r\n\t\t\t\t\t\t\tconst op = condition.op;\r\n\t\t\t\t\t\t\tconst var1Value = condition.vars[ 1 ].value;\r\n\r\n\t\t\t\t\t\t\t// some properties for field type.\r\n\t\t\t\t\t\t\tlet block;\r\n\t\t\t\t\t\t\tlet blockType;\r\n\t\t\t\t\t\t\tif ( var0Type === 'field' ) {\r\n\t\t\t\t\t\t\t\tblock = blocks.find(\r\n\t\t\t\t\t\t\t\t\t( $block ) =>\r\n\t\t\t\t\t\t\t\t\t\t$block.id === condition.vars[ 0 ].value\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tblockType = blockTypes[ block?.name ];\r\n\t\t\t\t\t\t\t\tif ( ! blockType ) {\r\n\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// possible operators list.\r\n\t\t\t\t\t\t\tlet operators: LogicConditionOperator[] | null =\r\n\t\t\t\t\t\t\t\tnull;\r\n\t\t\t\t\t\t\tif ( var0Type === 'field' ) {\r\n\t\t\t\t\t\t\t\tif ( blockType.logicalOperators ) {\r\n\t\t\t\t\t\t\t\t\toperators = blockType.logicalOperators;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if ( var0Type === 'variable' ) {\r\n\t\t\t\t\t\t\t\toperators = [\r\n\t\t\t\t\t\t\t\t\t'is',\r\n\t\t\t\t\t\t\t\t\t'is_not',\r\n\t\t\t\t\t\t\t\t\t'lower_than',\r\n\t\t\t\t\t\t\t\t\t'greater_than',\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( ! operators ) {\r\n\t\t\t\t\t\t\t\toperators = [\r\n\t\t\t\t\t\t\t\t\t'is',\r\n\t\t\t\t\t\t\t\t\t'is_not',\r\n\t\t\t\t\t\t\t\t\t'starts_with',\r\n\t\t\t\t\t\t\t\t\t'ends_with',\r\n\t\t\t\t\t\t\t\t\t'contains',\r\n\t\t\t\t\t\t\t\t\t'not_contains',\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet row1: any = null;\r\n\t\t\t\t\t\t\tlet row2: any = null;\r\n\r\n\t\t\t\t\t\t\t// row1 render.\r\n\t\t\t\t\t\t\trow1 = (\r\n\t\t\t\t\t\t\t\t<div className=\"condition-row-1\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-var0\">\r\n\t\t\t\t\t\t\t\t\t\t<ComboboxControl\r\n\t\t\t\t\t\t\t\t\t\t\texcerptLength={\r\n\t\t\t\t\t\t\t\t\t\t\t\tcombobox?.excerptLength ?? 30\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={ condition.vars[ 0 ] }\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var0 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][ ci ] = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvars: [ var0, {} ],\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\tisToggleEnabled={ false }\r\n\t\t\t\t\t\t\t\t\t\t\tcustomize={ customize }\r\n\t\t\t\t\t\t\t\t\t\t\thideChooseOption={ true }\r\n\t\t\t\t\t\t\t\t\t\t\tselectFirstOption={ true }\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-op\">\r\n\t\t\t\t\t\t\t\t\t\t{ var0Value && (\r\n\t\t\t\t\t\t\t\t\t\t\t<OperatorSelector\r\n\t\t\t\t\t\t\t\t\t\t\t\toperators={ operators }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ op ?? null }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( op ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][ ci ].op = op;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// row2 render.\r\n\t\t\t\t\t\t\tif ( var0Value ) {\r\n\t\t\t\t\t\t\t\trow2 = (\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-row-2\">\r\n\t\t\t\t\t\t\t\t\t\t{ var0Type === 'field' &&\r\n\t\t\t\t\t\t\t\t\t\tblockType.logicControl ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<blockType.logicControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tattributes={ block.attributes }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value }\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetValue={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t\tremoveCondition={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].splice(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) : var0Type === 'variable' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value ?? '' }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value ?? '' }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div key={ ci }>\r\n\t\t\t\t\t\t\t\t\t<div className=\"logic-conditions__condition\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"condition-rows\">\r\n\t\t\t\t\t\t\t\t\t\t\t{ row1 }\r\n\t\t\t\t\t\t\t\t\t\t\t{ row2 }\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{ group.length > 1 && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"condition-remove\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={ closeSmall }\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].splice(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tci,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{ group.length - 1 !== ci ? (\r\n\t\t\t\t\t\t\t\t\t\t<div>and</div>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"logic-conditions__add-condition\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tisPrimary\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].push( {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvars: [ {}, {} ],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{ value.length - 1 !== gi ? (\r\n\t\t\t\t\t\t<div className=\"logic-conditions__or\">- OR -</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"logic-conditions__add-group\">\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tisPrimary\r\n\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t$value.push( [ { vars: [ {}, {} ] } ] );\r\n\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tOR\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</div>\r\n\t\t\t) ) }\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LogicConditions;\r\n"],"mappings":"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"}