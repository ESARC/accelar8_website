{"version":3,"names":["_utils","require","_data","_lodash","_richText","useFields","_ref","section","blockTypes","formBlocks","useSelect","select","getBlockTypes","getBlocks","blocks","size","forEach","block","index","name","supports","editable","push","order","innerBlocks","childBlock","childIndex","identAlphabetically","parseInt","fields","blockType","type","value","id","label","attributes","getPlainExcerpt","iconBox","icon","color","isMergeTag","other","_default","exports","default"],"sources":["@quillforms/admin-components/src/combobox-control/use-fields.ts"],"sourcesContent":["/**\r\n * Quill Forms Dependencies\r\n */\r\n\r\nimport { identAlphabetically } from '@quillforms/utils';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { forEach, size } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport type { Options } from '.';\r\nimport { getPlainExcerpt } from '../rich-text';\r\nimport { FormBlocks } from '@quillforms/types/src';\r\n\r\nconst useFields = ( { section } ) => {\r\n\tconst { blockTypes, formBlocks } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tblockTypes: select( 'quillForms/blocks' ).getBlockTypes(),\r\n\t\t\t// @ts-expect-error\r\n\t\t\tformBlocks: select( 'quillForms/block-editor' ).getBlocks(),\r\n\t\t};\r\n\t} );\r\n\tconst blocks: FormBlocks = [];\r\n\r\n\tif ( size( formBlocks ) > 0 ) {\r\n\t\tforEach( formBlocks, ( block, index ) => {\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.editable ) {\r\n\t\t\t\tblocks.push( { ...block, order: index } );\r\n\t\t\t}\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.innerBlocks ) {\r\n\t\t\t\tif ( size( block?.innerBlocks ) > 0 ) {\r\n\t\t\t\t\tforEach( block.innerBlocks, ( childBlock, childIndex ) => {\r\n\t\t\t\t\t\tblocks.push( {\r\n\t\t\t\t\t\t\t...childBlock,\r\n\t\t\t\t\t\t\torder:\r\n\t\t\t\t\t\t\t\tindex +\r\n\t\t\t\t\t\t\t\tidentAlphabetically( parseInt( childIndex ) ),\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\tconst fields: Options = [];\r\n\tif ( size( blocks ) > 0 ) {\r\n\t\tfor ( const block of blocks ) {\r\n\t\t\tconst blockType = blockTypes[ block.name ];\r\n\t\t\tfields.push( {\r\n\t\t\t\ttype: 'field',\r\n\t\t\t\tvalue: block.id,\r\n\t\t\t\tlabel: block.attributes?.label\r\n\t\t\t\t\t? getPlainExcerpt( block.attributes.label )\r\n\t\t\t\t\t: '',\r\n\t\t\t\ticonBox: {\r\n\t\t\t\t\ticon: blockType?.icon,\r\n\t\t\t\t\tcolor: blockType?.color,\r\n\t\t\t\t},\r\n\t\t\t\tsection,\r\n\t\t\t\tisMergeTag: true,\r\n\t\t\t\tother: {\r\n\t\t\t\t\tname: block.name,\r\n\t\t\t\t},\r\n\t\t\t} );\r\n\t\t}\r\n\t}\r\n\r\n\treturn fields;\r\n};\r\n\r\nexport default useFields;\r\n"],"mappings":";;;;;;AAIA,IAAAA,MAAA,GAAAC,OAAA;AAKA,IAAAC,KAAA,GAAAD,OAAA;AAKA,IAAAE,OAAA,GAAAF,OAAA;AAMA,IAAAG,SAAA,GAAAH,OAAA;AApBA;AACA;AACA;;AAIA;AACA;AACA;;AAGA;AACA;AACA;;AAUA,MAAMI,SAAS,GAAGC,IAAA,IAAmB;EAAA,IAAjB;IAAEC;EAAQ,CAAC,GAAAD,IAAA;EAC9B,MAAM;IAAEE,UAAU;IAAEC;EAAW,CAAC,GAAG,IAAAC,eAAS,EAAIC,MAAM,IAAM;IAC3D,OAAO;MACNH,UAAU,EAAEG,MAAM,CAAE,mBAAmB,CAAE,CAACC,aAAa,EAAE;MACzD;MACAH,UAAU,EAAEE,MAAM,CAAE,yBAAyB,CAAE,CAACE,SAAS;IAC1D,CAAC;EACF,CAAC,CAAE;EACH,MAAMC,MAAkB,GAAG,EAAE;EAE7B,IAAK,IAAAC,YAAI,EAAEN,UAAU,CAAE,GAAG,CAAC,EAAG;IAC7B,IAAAO,eAAO,EAAEP,UAAU,EAAE,CAAEQ,KAAK,EAAEC,KAAK,KAAM;MACxC,IAAKV,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE,EAAEC,QAAQ,EAAEC,QAAQ,EAAG;QACnDP,MAAM,CAACQ,IAAI,CAAE;UAAE,GAAGL,KAAK;UAAEM,KAAK,EAAEL;QAAM,CAAC,CAAE;MAC1C;MACA,IAAKV,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE,EAAEC,QAAQ,EAAEI,WAAW,EAAG;QACtD,IAAK,IAAAT,YAAI,EAAEE,KAAK,EAAEO,WAAW,CAAE,GAAG,CAAC,EAAG;UACrC,IAAAR,eAAO,EAAEC,KAAK,CAACO,WAAW,EAAE,CAAEC,UAAU,EAAEC,UAAU,KAAM;YACzDZ,MAAM,CAACQ,IAAI,CAAE;cACZ,GAAGG,UAAU;cACbF,KAAK,EACJL,KAAK,GACL,IAAAS,0BAAmB,EAAEC,QAAQ,CAAEF,UAAU,CAAE;YAC7C,CAAC,CAAE;UACJ,CAAC,CAAE;QACJ;MACD;IACD,CAAC,CAAE;EACJ;EACA,MAAMG,MAAe,GAAG,EAAE;EAC1B,IAAK,IAAAd,YAAI,EAAED,MAAM,CAAE,GAAG,CAAC,EAAG;IACzB,KAAM,MAAMG,KAAK,IAAIH,MAAM,EAAG;MAC7B,MAAMgB,SAAS,GAAGtB,UAAU,CAAES,KAAK,CAACE,IAAI,CAAE;MAC1CU,MAAM,CAACP,IAAI,CAAE;QACZS,IAAI,EAAE,OAAO;QACbC,KAAK,EAAEf,KAAK,CAACgB,EAAE;QACfC,KAAK,EAAEjB,KAAK,CAACkB,UAAU,EAAED,KAAK,GAC3B,IAAAE,yBAAe,EAAEnB,KAAK,CAACkB,UAAU,CAACD,KAAK,CAAE,GACzC,EAAE;QACLG,OAAO,EAAE;UACRC,IAAI,EAAER,SAAS,EAAEQ,IAAI;UACrBC,KAAK,EAAET,SAAS,EAAES;QACnB,CAAC;QACDhC,OAAO;QACPiC,UAAU,EAAE,IAAI;QAChBC,KAAK,EAAE;UACNtB,IAAI,EAAEF,KAAK,CAACE;QACb;MACD,CAAC,CAAE;IACJ;EACD;EAEA,OAAOU,MAAM;AACd,CAAC;AAAC,IAAAa,QAAA,GAEarC,SAAS;AAAAsC,OAAA,CAAAC,OAAA,GAAAF,QAAA"}