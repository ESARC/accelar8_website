{"version":3,"names":["_data","require","_react","_components","_icons","_lodash","_comboboxControl","_interopRequireDefault","_operatorSelector","_textControl","_button","LogicConditions","_ref","value","onChange","combobox","formBlocks","blockTypes","useSelect","select","getBlocks","getBlockTypes","blocks","size","forEach","block","name","supports","editable","push","innerBlocks","childBlock","useEffect","Array","isArray","length","vars","customize","override","handler","customizable","sections","options","filter","section","includes","key","option","type","_option$other$name","blockType","other","logic","logicConditions","customized","_element","createElement","className","map","group","gi","Icon","icon","closeSmall","onClick","$value","splice","condition","ci","_combobox$excerptLeng","var0Type","var0Value","op","var1Value","find","$block","id","operators","logicalOperators","row1","row2","default","excerptLength","var0","isToggleEnabled","hideChooseOption","selectFirstOption","logicControl","attributes","setValue","var1","removeCondition","isPrimary","_default","exports"],"sources":["@quillforms/admin-components/src/logic-conditions/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport {\r\n\tEditorLogicCondition,\r\n\tFormBlocks,\r\n\tLogicConditionOperator,\r\n} from '@quillforms/types';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useSelect } from '@wordpress/data';\r\nimport { useEffect } from 'react';\r\nimport { Icon } from '@wordpress/components';\r\nimport { closeSmall } from '@wordpress/icons';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { forEach, size } from 'lodash';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport ComboboxControl, {\r\n\tCustomizeFunction,\r\n\tCustomizeObject,\r\n} from '../combobox-control';\r\nimport OperatorSelector from './operator-selector';\r\nimport TextControl from '../text-control';\r\nimport Button from '../button';\r\n\r\nexport type LogicConditionsProps = {\r\n\tvalue: EditorLogicCondition[][];\r\n\tonChange: ( value: EditorLogicCondition[][] ) => void;\r\n\tcombobox?: {\r\n\t\tcustomize?: {\r\n\t\t\thandler: CustomizeFunction;\r\n\t\t\toverride?: boolean;\r\n\t\t};\r\n\t\texcerptLength?: number;\r\n\t};\r\n};\r\n\r\nconst LogicConditions: React.FC< LogicConditionsProps > = ( {\r\n\tvalue,\r\n\tonChange,\r\n\tcombobox,\r\n} ) => {\r\n\tconst { formBlocks, blockTypes } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\t// @ts-ignore\r\n\t\t\tformBlocks: select( 'quillForms/block-editor' ).getBlocks(),\r\n\t\t\tblockTypes: select( 'quillForms/blocks' ).getBlockTypes(),\r\n\t\t};\r\n\t} );\r\n\r\n\tconst blocks: FormBlocks = [];\r\n\r\n\tif ( size( formBlocks ) > 0 ) {\r\n\t\tforEach( formBlocks, ( block ) => {\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.editable ) {\r\n\t\t\t\tblocks.push( { ...block } );\r\n\t\t\t}\r\n\t\t\tif ( blockTypes[ block.name ]?.supports?.innerBlocks ) {\r\n\t\t\t\tif ( size( block?.innerBlocks ) > 0 ) {\r\n\t\t\t\t\tforEach( block.innerBlocks, ( childBlock ) => {\r\n\t\t\t\t\t\tblocks.push( {\r\n\t\t\t\t\t\t\t...childBlock,\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t} );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} );\r\n\t}\r\n\t// update value on mount if input isn't array or is empty array.\r\n\tuseEffect( () => {\r\n\t\tif ( ! Array.isArray( value ) || value.length === 0 ) {\r\n\t\t\tonChange( [ [ { vars: [ {}, {} ] } ] ] );\r\n\t\t}\r\n\t}, [] );\r\n\r\n\tconst customize = combobox?.customize?.override\r\n\t\t? combobox.customize.handler\r\n\t\t: ( customizable: CustomizeObject ) => {\r\n\t\t\t\tlet { sections, options } = customizable;\r\n\t\t\t\tsections = sections.filter( ( section ) =>\r\n\t\t\t\t\t[ 'fields', 'variables', 'hidden_fields' ].includes(\r\n\t\t\t\t\t\tsection.key\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\toptions = options.filter( ( option ) => {\r\n\t\t\t\t\tif ( option.type === 'field' ) {\r\n\t\t\t\t\t\tconst blockType =\r\n\t\t\t\t\t\t\tblockTypes[ option.other?.name ?? '' ];\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\tblockType?.supports?.logic &&\r\n\t\t\t\t\t\t\tblockType?.supports?.logicConditions\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t[ 'variable', 'hidden_field' ].includes( option.type )\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif ( combobox?.customize ) {\r\n\t\t\t\t\tconst customized = combobox.customize.handler( {\r\n\t\t\t\t\t\tsections,\r\n\t\t\t\t\t\toptions,\r\n\t\t\t\t\t} );\r\n\t\t\t\t\tsections = customized.sections;\r\n\t\t\t\t\toptions = customized.options;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn { sections, options };\r\n\t\t  };\r\n\r\n\tif ( ! Array.isArray( value ) ) {\r\n\t\treturn null;\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"logic-conditions\">\r\n\t\t\t{ value.map( ( group, gi ) => (\r\n\t\t\t\t<div key={ gi }>\r\n\t\t\t\t\t<div className=\"logic-conditions__group\">\r\n\t\t\t\t\t\t{ value.length > 1 && (\r\n\t\t\t\t\t\t\t<div className=\"group-remove\">\r\n\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\ticon={ closeSmall }\r\n\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t$value.splice( gi, 1 );\r\n\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t{ group.map( ( condition, ci ) => {\r\n\t\t\t\t\t\t\tconst var0Type = condition.vars[ 0 ].type;\r\n\t\t\t\t\t\t\tconst var0Value = condition.vars[ 0 ].value;\r\n\t\t\t\t\t\t\tconst op = condition.op;\r\n\t\t\t\t\t\t\tconst var1Value = condition.vars[ 1 ].value;\r\n\r\n\t\t\t\t\t\t\t// some properties for field type.\r\n\t\t\t\t\t\t\tlet block;\r\n\t\t\t\t\t\t\tlet blockType;\r\n\t\t\t\t\t\t\tif ( var0Type === 'field' ) {\r\n\t\t\t\t\t\t\t\tblock = blocks.find(\r\n\t\t\t\t\t\t\t\t\t( $block ) =>\r\n\t\t\t\t\t\t\t\t\t\t$block.id === condition.vars[ 0 ].value\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\tblockType = blockTypes[ block?.name ];\r\n\t\t\t\t\t\t\t\tif ( ! blockType ) {\r\n\t\t\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// possible operators list.\r\n\t\t\t\t\t\t\tlet operators: LogicConditionOperator[] | null =\r\n\t\t\t\t\t\t\t\tnull;\r\n\t\t\t\t\t\t\tif ( var0Type === 'field' ) {\r\n\t\t\t\t\t\t\t\tif ( blockType.logicalOperators ) {\r\n\t\t\t\t\t\t\t\t\toperators = blockType.logicalOperators;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if ( var0Type === 'variable' ) {\r\n\t\t\t\t\t\t\t\toperators = [\r\n\t\t\t\t\t\t\t\t\t'is',\r\n\t\t\t\t\t\t\t\t\t'is_not',\r\n\t\t\t\t\t\t\t\t\t'lower_than',\r\n\t\t\t\t\t\t\t\t\t'greater_than',\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif ( ! operators ) {\r\n\t\t\t\t\t\t\t\toperators = [\r\n\t\t\t\t\t\t\t\t\t'is',\r\n\t\t\t\t\t\t\t\t\t'is_not',\r\n\t\t\t\t\t\t\t\t\t'starts_with',\r\n\t\t\t\t\t\t\t\t\t'ends_with',\r\n\t\t\t\t\t\t\t\t\t'contains',\r\n\t\t\t\t\t\t\t\t\t'not_contains',\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet row1: any = null;\r\n\t\t\t\t\t\t\tlet row2: any = null;\r\n\r\n\t\t\t\t\t\t\t// row1 render.\r\n\t\t\t\t\t\t\trow1 = (\r\n\t\t\t\t\t\t\t\t<div className=\"condition-row-1\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-var0\">\r\n\t\t\t\t\t\t\t\t\t\t<ComboboxControl\r\n\t\t\t\t\t\t\t\t\t\t\texcerptLength={\r\n\t\t\t\t\t\t\t\t\t\t\t\tcombobox?.excerptLength ?? 30\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={ condition.vars[ 0 ] }\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var0 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][ ci ] = {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvars: [ var0, {} ],\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\tisToggleEnabled={ false }\r\n\t\t\t\t\t\t\t\t\t\t\tcustomize={ customize }\r\n\t\t\t\t\t\t\t\t\t\t\thideChooseOption={ true }\r\n\t\t\t\t\t\t\t\t\t\t\tselectFirstOption={ true }\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-op\">\r\n\t\t\t\t\t\t\t\t\t\t{ var0Value && (\r\n\t\t\t\t\t\t\t\t\t\t\t<OperatorSelector\r\n\t\t\t\t\t\t\t\t\t\t\t\toperators={ operators }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ op ?? null }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( op ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][ ci ].op = op;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t// row2 render.\r\n\t\t\t\t\t\t\tif ( var0Value ) {\r\n\t\t\t\t\t\t\t\trow2 = (\r\n\t\t\t\t\t\t\t\t\t<div className=\"condition-row-2\">\r\n\t\t\t\t\t\t\t\t\t\t{ var0Type === 'field' &&\r\n\t\t\t\t\t\t\t\t\t\tblockType.logicControl ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<blockType.logicControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tattributes={ block.attributes }\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value }\r\n\t\t\t\t\t\t\t\t\t\t\t\tsetValue={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t\tremoveCondition={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].splice(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) : var0Type === 'variable' ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value ?? '' }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<TextControl\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={ var1Value ?? '' }\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={ ( var1 ) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ][\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tci\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t].vars[ 1 ].value = var1;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div key={ ci }>\r\n\t\t\t\t\t\t\t\t\t<div className=\"logic-conditions__condition\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"condition-rows\">\r\n\t\t\t\t\t\t\t\t\t\t\t{ row1 }\r\n\t\t\t\t\t\t\t\t\t\t\t{ row2 }\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t{ group.length > 1 && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"condition-remove\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Icon\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ticon={ closeSmall }\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...value,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].splice(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tci,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{ group.length - 1 !== ci ? (\r\n\t\t\t\t\t\t\t\t\t\t<div>and</div>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"logic-conditions__add-condition\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\t\t\t\t\tisPrimary\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t$value[ gi ].push( {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvars: [ {}, {} ],\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\tand\r\n\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} ) }\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{ value.length - 1 !== gi ? (\r\n\t\t\t\t\t\t<div className=\"logic-conditions__or\">- OR -</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"logic-conditions__add-group\">\r\n\t\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\t\tisPrimary\r\n\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\tconst $value = [ ...value ];\r\n\t\t\t\t\t\t\t\t\t$value.push( [ { vars: [ {}, {} ] } ] );\r\n\t\t\t\t\t\t\t\t\tonChange( $value );\r\n\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tOR\r\n\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</div>\r\n\t\t\t) ) }\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default LogicConditions;\r\n"],"mappings":"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"}