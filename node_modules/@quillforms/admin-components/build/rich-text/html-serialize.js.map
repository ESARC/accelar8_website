{"version":3,"names":["_autop","require","_escapeHtml","_interopRequireDefault","_slate","_lodash","htmlSerialize","value","removep","serialize","node","nodeText","escapeHtml","text","Text","isText","bold","italic","Array","isArray","map","subNode","serializeNode","join","children","size","n","type","url","data","modifier","_default","exports","default"],"sources":["@quillforms/admin-components/src/rich-text/html-serialize.ts"],"sourcesContent":["/**\r\n * WordPress Dependencies\r\n */\r\nimport { removep } from '@wordpress/autop';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport escapeHtml from 'escape-html';\r\nimport { Text, Node } from 'slate';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport type { CustomNode, MergeTag } from './types';\r\nimport { size } from 'lodash';\r\nconst htmlSerialize = ( value: Node ): string => {\r\n\treturn removep( serialize( value ) );\r\n};\r\nconst serialize = ( node: CustomNode ) => {\r\n\tlet nodeText = escapeHtml( node.text );\r\n\tif ( Text.isText( node ) ) {\r\n\t\tif ( node.bold ) {\r\n\t\t\tnodeText = `<strong>` + nodeText + `</strong>`;\r\n\t\t}\r\n\r\n\t\tif ( node.italic ) {\r\n\t\t\tnodeText = `<em>` + nodeText + `</em>`;\r\n\t\t}\r\n\r\n\t\tif ( nodeText === '' ) {\r\n\t\t\treturn '<br />';\r\n\t\t}\r\n\r\n\t\treturn nodeText;\r\n\t}\r\n\r\n\tif ( Array.isArray( node ) ) {\r\n\t\treturn node\r\n\t\t\t.map( ( subNode ) => {\r\n\t\t\t\treturn serializeNode( subNode );\r\n\t\t\t} )\r\n\t\t\t.join( '' );\r\n\t}\r\n\r\n\treturn serializeNode( node );\r\n};\r\n\r\nconst serializeNode = ( node: CustomNode ) => {\r\n\tconst children =\r\n\t\tsize( node.children ) > 0\r\n\t\t\t? node.children.map( ( n ) => serialize( n ) ).join( '' )\r\n\t\t\t: '';\r\n\tswitch ( node.type ) {\r\n\t\tcase 'link':\r\n\t\t\treturn `<a target=\"_blank\" href=\"${ escapeHtml(\r\n\t\t\t\tnode.url\r\n\t\t\t) }\">${ children }</a>`;\r\n\t\tcase 'mergeTag':\r\n\t\t\treturn `{{${ ( node.data as MergeTag ).type }:${\r\n\t\t\t\t( node.data as MergeTag ).modifier\r\n\t\t\t}}}`;\r\n\t\tcase 'paragraph':\r\n\t\t\treturn `<p>${ children }</p>`;\r\n\t\tdefault:\r\n\t\t\treturn `${ children }`;\r\n\t}\r\n};\r\n\r\nexport default htmlSerialize;\r\n"],"mappings":";;;;;;;AAGA,IAAAA,MAAA,GAAAC,OAAA;AAKA,IAAAC,WAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,MAAA,GAAAH,OAAA;AAMA,IAAAI,OAAA,GAAAJ,OAAA;AAfA;AACA;AACA;;AAGA;AACA;AACA;;AASA,MAAMK,aAAa,GAAKC,KAAW,IAAc;EAChD,OAAO,IAAAC,cAAO,EAAEC,SAAS,CAAEF,KAAK,CAAE,CAAE;AACrC,CAAC;AACD,MAAME,SAAS,GAAKC,IAAgB,IAAM;EACzC,IAAIC,QAAQ,GAAG,IAAAC,mBAAU,EAAEF,IAAI,CAACG,IAAI,CAAE;EACtC,IAAKC,WAAI,CAACC,MAAM,CAAEL,IAAI,CAAE,EAAG;IAC1B,IAAKA,IAAI,CAACM,IAAI,EAAG;MAChBL,QAAQ,GAAI,UAAS,GAAGA,QAAQ,GAAI,WAAU;IAC/C;IAEA,IAAKD,IAAI,CAACO,MAAM,EAAG;MAClBN,QAAQ,GAAI,MAAK,GAAGA,QAAQ,GAAI,OAAM;IACvC;IAEA,IAAKA,QAAQ,KAAK,EAAE,EAAG;MACtB,OAAO,QAAQ;IAChB;IAEA,OAAOA,QAAQ;EAChB;EAEA,IAAKO,KAAK,CAACC,OAAO,CAAET,IAAI,CAAE,EAAG;IAC5B,OAAOA,IAAI,CACTU,GAAG,CAAIC,OAAO,IAAM;MACpB,OAAOC,aAAa,CAAED,OAAO,CAAE;IAChC,CAAC,CAAE,CACFE,IAAI,CAAE,EAAE,CAAE;EACb;EAEA,OAAOD,aAAa,CAAEZ,IAAI,CAAE;AAC7B,CAAC;AAED,MAAMY,aAAa,GAAKZ,IAAgB,IAAM;EAC7C,MAAMc,QAAQ,GACb,IAAAC,YAAI,EAAEf,IAAI,CAACc,QAAQ,CAAE,GAAG,CAAC,GACtBd,IAAI,CAACc,QAAQ,CAACJ,GAAG,CAAIM,CAAC,IAAMjB,SAAS,CAAEiB,CAAC,CAAE,CAAE,CAACH,IAAI,CAAE,EAAE,CAAE,GACvD,EAAE;EACN,QAASb,IAAI,CAACiB,IAAI;IACjB,KAAK,MAAM;MACV,OAAQ,4BAA4B,IAAAf,mBAAU,EAC7CF,IAAI,CAACkB,GAAG,CACN,KAAKJ,QAAU,MAAK;IACxB,KAAK,UAAU;MACd,OAAQ,KAAOd,IAAI,CAACmB,IAAI,CAAeF,IAAM,IAC1CjB,IAAI,CAACmB,IAAI,CAAeC,QAC1B,IAAG;IACL,KAAK,WAAW;MACf,OAAQ,MAAMN,QAAU,MAAK;IAC9B;MACC,OAAQ,GAAGA,QAAU,EAAC;EAAC;AAE1B,CAAC;AAAC,IAAAO,QAAA,GAEazB,aAAa;AAAA0B,OAAA,CAAAC,OAAA,GAAAF,QAAA"}