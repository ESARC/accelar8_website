{"version":3,"names":["_react","require","_components","_slate","_slateReact","_emotion","_element2","_interopRequireDefault","_hoveringToolbar","_mergeTagListItem","TextEditor","props","editor","placeholder","color","onChange","value","onFocus","mergeTags","allowedFormats","wrapperRef","useRef","PopoverRef","ref","target","setTarget","useState","index","setIndex","search","setSearch","$mergeTags","filter","c","label","toLowerCase","startsWith","isFormatActive","format","match","Editor","nodes","n","mode","renderElement","$props","_element","createElement","default","_extends2","toggleFormat","active","Transforms","setNodes","Text","isText","split","Leaf","_ref","attributes","children","leaf","bold","italic","insertMergeTag","mergeTag","insertNodes","type","data","modifier","text","setTimeout","move","onKeyDown","useCallback","event","key","length","preventDefault","prevIndex","nextIndex","select","undefined","useEffect","handleClickOutsidePortal","current","contains","document","addEventListener","removeEventListener","Fragment","className","style","width","Slate","val","selection","Range","isCollapsed","start","edges","wordBefore","before","beforeRange","range","beforeText","string","beforeMatch","endsWith","after","afterRange","afterText","afterMatch","formattingControls","Editable","renderLeaf","onDOMBeforeInput","inputType","Popover","css","map","i","onClick","ReactEditor","focus","onMouseEnter","isSelected","_default","exports"],"sources":["@quillforms/admin-components/src/rich-text/components/editor/index.tsx"],"sourcesContent":["/* eslint-disable no-nested-ternary */\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { Fragment, useCallback, useEffect, useState, useRef } from 'react';\r\nimport { Popover } from '@wordpress/components';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { Transforms, Text, Editor, Range, Node as SlateNode } from 'slate';\r\nimport { Slate, Editable, ReactEditor, RenderElementProps } from 'slate-react';\r\nimport { HistoryEditor } from 'slate-history';\r\nimport { css } from 'emotion';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport Element from '../element';\r\nimport HoveringToolbar from '../hovering-toolbar';\r\nimport MergeTagListItem from '../merge-tag-list-item';\r\nimport type {\r\n\tMergeTags,\r\n\tMergeTagsSections,\r\n\tMergeTag,\r\n\tallowedFormats,\r\n} from '../../types';\r\ninterface Props {\r\n\teditor: ReactEditor & HistoryEditor;\r\n\tplaceholder?: string;\r\n\tcolor?: string;\r\n\tvalue: SlateNode[];\r\n\tonChange: ( value: SlateNode[] ) => void;\r\n\tonFocus: React.FocusEventHandler;\r\n\tmergeTags?: MergeTags;\r\n\tmergeTagsSections?: MergeTagsSections;\r\n\tallowedFormats?: allowedFormats;\r\n}\r\nconst TextEditor: React.FC< Props > = ( props ) => {\r\n\tconst {\r\n\t\teditor,\r\n\t\tplaceholder,\r\n\t\tcolor,\r\n\t\tonChange,\r\n\t\tvalue,\r\n\t\tonFocus,\r\n\t\tmergeTags = [],\r\n\t\t// mergeTagsSections = [\r\n\t\t// \t{ key: 'field', label: 'Fields' },\r\n\t\t// \t{ key: 'variable', label: 'Variables' },\r\n\t\t// \t{ key: 'hidden_field', label: 'Hidden Fields' },\r\n\t\t// ],\r\n\t\tallowedFormats = [],\r\n\t} = props;\r\n\r\n\tconst wrapperRef = useRef< HTMLDivElement >( null );\r\n\tconst PopoverRef = useRef( null );\r\n\tconst ref = useRef< HTMLDivElement >( null );\r\n\tconst [ target, setTarget ] = useState< Range | undefined >();\r\n\tconst [ index, setIndex ] = useState( 0 );\r\n\tconst [ search, setSearch ] = useState( '' );\r\n\r\n\tconst $mergeTags = mergeTags.filter( ( c ) => {\r\n\t\tif ( search ) {\r\n\t\t\treturn c.label\r\n\t\t\t\t?.toLowerCase()\r\n\t\t\t\t.startsWith( search ? search.toLowerCase() : '' );\r\n\t\t}\r\n\t\treturn true;\r\n\t} );\r\n\r\n\tconst isFormatActive = ( format ) => {\r\n\t\tconst [ match ] = Editor.nodes( editor, {\r\n\t\t\tmatch: ( n ) => n[ format ] === true,\r\n\t\t\tmode: 'all',\r\n\t\t} );\r\n\t\treturn !! match;\r\n\t};\r\n\r\n\tconst renderElement = ( $props: RenderElementProps ) => (\r\n\t\t<Element editor={ editor } { ...$props } mergeTags={ mergeTags } />\r\n\t);\r\n\r\n\tconst toggleFormat = ( editor: Editor, format ) => {\r\n\t\tconst active = isFormatActive( format );\r\n\t\tTransforms.setNodes(\r\n\t\t\teditor,\r\n\t\t\t{ [ format ]: active ? null : true },\r\n\t\t\t{ match: Text.isText, split: true }\r\n\t\t);\r\n\t};\r\n\r\n\tconst Leaf = ( { attributes, children, leaf } ) => {\r\n\t\tif ( leaf.bold ) {\r\n\t\t\tchildren = <strong>{ children }</strong>;\r\n\t\t}\r\n\r\n\t\tif ( leaf.italic ) {\r\n\t\t\tchildren = <em>{ children }</em>;\r\n\t\t}\r\n\r\n\t\treturn <span { ...attributes }>{ children }</span>;\r\n\t};\r\n\r\n\t// Insert Variable\r\n\tconst insertMergeTag = ( mergeTag: MergeTag ) => {\r\n\t\tTransforms.insertNodes( editor, {\r\n\t\t\ttype: 'mergeTag',\r\n\t\t\tdata: {\r\n\t\t\t\ttype: mergeTag.type,\r\n\t\t\t\tmodifier: mergeTag.modifier,\r\n\t\t\t},\r\n\t\t\tchildren: [ { text: '' } ],\r\n\t\t} );\r\n\t\tsetTimeout( () => {\r\n\t\t\tTransforms.move( editor );\r\n\t\t}, 0 );\r\n\t};\r\n\r\n\tconst onKeyDown = useCallback(\r\n\t\t( event ) => {\r\n\t\t\tif ( event.key === 'Enter' && allowedFormats?.length === 0 ) {\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t\tif ( target ) {\r\n\t\t\t\tswitch ( event.key ) {\r\n\t\t\t\t\tcase 'ArrowDown':\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tconst prevIndex =\r\n\t\t\t\t\t\t\tindex >= $mergeTags.length - 1 ? 0 : index + 1;\r\n\t\t\t\t\t\tsetIndex( prevIndex );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'ArrowUp':\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tconst nextIndex =\r\n\t\t\t\t\t\t\tindex <= 0 ? $mergeTags.length - 1 : index - 1;\r\n\t\t\t\t\t\tsetIndex( nextIndex );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Tab':\r\n\t\t\t\t\tcase 'Enter':\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tTransforms.select( editor, target );\r\n\t\t\t\t\t\tinsertMergeTag( $mergeTags[ index ] );\r\n\t\t\t\t\t\tsetTarget( undefined );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'Escape':\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t\tsetTarget( undefined );\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ index, search, target ]\r\n\t);\r\n\r\n\t// useEffect( () => {\r\n\t// \tif ( target && $mergeTags.length > 0 ) {\r\n\t// \t\tconst el: HTMLDivElement | null = ref.current;\r\n\t// \t\tconst domRange = ReactEditor.toDOMRange( editor, target );\r\n\t// \t\tconst rect = domRange.getBoundingClientRect();\r\n\t// \t\tif ( el ) {\r\n\t// \t\t\tel.style.top = `${ rect.top + window.pageYOffset + 24 }px`;\r\n\t// \t\t\tel.style.left = `${ rect.left + window.pageXOffset }px`;\r\n\t// \t\t}\r\n\t// \t}\r\n\t// }, [ $mergeTags.length, editor, index, search, target ] );\r\n\r\n\tuseEffect( () => {\r\n\t\t/**\r\n\t\t * Alert if clicked on outside of element\r\n\t\t *\r\n\t\t * @param  event\r\n\t\t */\r\n\t\tfunction handleClickOutsidePortal( event: MouseEvent ): void {\r\n\t\t\tif (\r\n\t\t\t\tPopoverRef.current &&\r\n\t\t\t\tref.current &&\r\n\t\t\t\t// @ts-expect-error\r\n\t\t\t\t! PopoverRef.current.contains( event.target as Node ) &&\r\n\t\t\t\t! ref.current.contains( event.target as Node )\r\n\t\t\t) {\r\n\t\t\t\tsetTarget( undefined );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Bind the event listener\r\n\t\tdocument.addEventListener( 'mousedown', handleClickOutsidePortal );\r\n\t\treturn () => {\r\n\t\t\t// Unbind the event listener on clean up\r\n\t\t\tdocument.removeEventListener(\r\n\t\t\t\t'mousedown',\r\n\t\t\t\thandleClickOutsidePortal\r\n\t\t\t);\r\n\t\t};\r\n\t}, [ PopoverRef ] );\r\n\r\n\treturn (\r\n\t\t<Fragment>\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"richtext__editor\"\r\n\t\t\t\tstyle={ { width: '100%' } }\r\n\t\t\t\tref={ wrapperRef }\r\n\t\t\t>\r\n\t\t\t\t<Slate\r\n\t\t\t\t\teditor={ editor }\r\n\t\t\t\t\tvalue={ value }\r\n\t\t\t\t\tonChange={ ( val ) => {\r\n\t\t\t\t\t\tonChange( val );\r\n\t\t\t\t\t\tconst { selection } = editor;\r\n\r\n\t\t\t\t\t\tif ( selection && Range.isCollapsed( selection ) ) {\r\n\t\t\t\t\t\t\tconst [ start ] = Range.edges( selection );\r\n\t\t\t\t\t\t\tconst wordBefore = selection;\r\n\t\t\t\t\t\t\tconst before =\r\n\t\t\t\t\t\t\t\twordBefore &&\r\n\t\t\t\t\t\t\t\tEditor.before( editor, wordBefore );\r\n\t\t\t\t\t\t\tconst beforeRange =\r\n\t\t\t\t\t\t\t\tbefore && Editor.range( editor, before, start );\r\n\t\t\t\t\t\t\tconst beforeText =\r\n\t\t\t\t\t\t\t\tbeforeRange &&\r\n\t\t\t\t\t\t\t\tEditor.string( editor, beforeRange );\r\n\t\t\t\t\t\t\tconst beforeMatch =\r\n\t\t\t\t\t\t\t\tbeforeText && beforeText.endsWith( '@' );\r\n\t\t\t\t\t\t\tconst after = Editor.after( editor, start );\r\n\t\t\t\t\t\t\tconst afterRange = Editor.range(\r\n\t\t\t\t\t\t\t\teditor,\r\n\t\t\t\t\t\t\t\tstart,\r\n\t\t\t\t\t\t\t\tafter\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tconst afterText = Editor.string(\r\n\t\t\t\t\t\t\t\teditor,\r\n\t\t\t\t\t\t\t\tafterRange\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tconst afterMatch = afterText.match( /^(\\s|$)/ );\r\n\r\n\t\t\t\t\t\t\tif ( beforeMatch && afterMatch ) {\r\n\t\t\t\t\t\t\t\tsetTarget( beforeRange );\r\n\t\t\t\t\t\t\t\tsetSearch( beforeMatch[ 1 ] );\r\n\t\t\t\t\t\t\t\tsetIndex( 0 );\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tsetTarget( undefined );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} }\r\n\t\t\t\t>\r\n\t\t\t\t\t{ allowedFormats?.length > 0 && (\r\n\t\t\t\t\t\t<HoveringToolbar\r\n\t\t\t\t\t\t\tformattingControls={ allowedFormats }\r\n\t\t\t\t\t\t\ttoggleFormat={ ( format ) =>\r\n\t\t\t\t\t\t\t\ttoggleFormat( editor, format )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisFormatActive={ ( format ) =>\r\n\t\t\t\t\t\t\t\tisFormatActive( format )\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) }\r\n\t\t\t\t\t<Editable\r\n\t\t\t\t\t\tstyle={ { color } }\r\n\t\t\t\t\t\tcolor={ color }\r\n\t\t\t\t\t\trenderLeaf={ ( $props ) => <Leaf { ...$props } /> }\r\n\t\t\t\t\t\trenderElement={ renderElement }\r\n\t\t\t\t\t\tplaceholder={ placeholder }\r\n\t\t\t\t\t\tonFocus={ onFocus }\r\n\t\t\t\t\t\tonKeyDown={ onKeyDown }\r\n\t\t\t\t\t\tonDOMBeforeInput={ ( event: Event ) => {\r\n\t\t\t\t\t\t\tswitch ( ( event as InputEvent ).inputType ) {\r\n\t\t\t\t\t\t\t\tcase 'formatBold':\r\n\t\t\t\t\t\t\t\t\treturn toggleFormat( editor, 'bold' );\r\n\t\t\t\t\t\t\t\tcase 'formatItalic':\r\n\t\t\t\t\t\t\t\t\treturn toggleFormat( editor, 'italic' );\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t{ target && $mergeTags.length > 0 && (\r\n\t\t\t\t\t\t<Popover\r\n\t\t\t\t\t\t\tref={ PopoverRef }\r\n\t\t\t\t\t\t\tclassName={ css`\r\n\t\t\t\t\t\t\t\tz-index: 1111111111111111111;\r\n\t\t\t\t\t\t\t\t.components-popover__content {\r\n\t\t\t\t\t\t\t\t\tpadding: 3px;\r\n\t\t\t\t\t\t\t\t\tborder: none;\r\n\t\t\t\t\t\t\t\t\tborder-radius: 4px;\r\n\t\t\t\t\t\t\t\t\tbox-shadow: 0 1px 5px rgba( 0, 0, 0, 0.2 );\r\n\t\t\t\t\t\t\t\t\tz-index: 111111111111111111;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t` }\r\n\t\t\t\t\t\t\tonKeyDown={ onKeyDown }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={ css`\r\n\t\t\t\t\t\t\t\t\tpadding: 5px 25px;\r\n\t\t\t\t\t\t\t\t\tfont-weight: bold;\r\n\t\t\t\t\t\t\t\t` }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tRecall Information from...\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName=\"rich-text-merge-tag-list\"\r\n\t\t\t\t\t\t\t\tref={ ref }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{ $mergeTags.map( ( mergeTag, i ) => (\r\n\t\t\t\t\t\t\t\t\t<MergeTagListItem\r\n\t\t\t\t\t\t\t\t\t\tkey={ `merge-tag-${ i }` }\r\n\t\t\t\t\t\t\t\t\t\tmergeTag={ mergeTag }\r\n\t\t\t\t\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\t\t\t\t\tTransforms.select( editor, target );\r\n\t\t\t\t\t\t\t\t\t\t\tinsertMergeTag( mergeTag );\r\n\t\t\t\t\t\t\t\t\t\t\tReactEditor.focus( editor );\r\n\t\t\t\t\t\t\t\t\t\t} }\r\n\t\t\t\t\t\t\t\t\t\tonMouseEnter={ () => setIndex( i ) }\r\n\t\t\t\t\t\t\t\t\t\tisSelected={ index === i }\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t) ) }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</Popover>\r\n\t\t\t\t\t) }\r\n\t\t\t\t</Slate>\r\n\t\t\t</div>\r\n\t\t</Fragment>\r\n\t);\r\n};\r\n\r\n/**\r\n * Export.\r\n */\r\nexport default TextEditor;\r\n"],"mappings":"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"}