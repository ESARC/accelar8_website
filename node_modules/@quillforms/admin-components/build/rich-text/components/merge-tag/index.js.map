{"version":3,"names":["_react","require","_components","_icons","_slate","_classnames","_interopRequireDefault","_emotion","_getPlainExcerpt","EditorMergeTag","_ref","attributes","editor","children","path","element","mergeTags","type","modifier","data","node","Editor","mergeTag","find","a","mergeTagIcon","icon","plus","renderedIcon","_element","createElement","Icon","src","useEffect","apply","Transforms","insertNodes","text","at","Fragment","_extends2","default","contentEditable","className","classnames","css","color","dangerouslySetInnerHTML","__html","getPlainExcerpt","label","onClick","setTimeout","close","_default","exports"],"sources":["@quillforms/admin-components/src/rich-text/components/merge-tag/index.tsx"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport type { IconDescriptor, Icon as IconType } from '@quillforms/types';\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useEffect } from 'react';\r\n// @ts-expect-error\r\nimport { Icon, Dashicon } from '@wordpress/components';\r\nimport { plus, close } from '@wordpress/icons';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { Editor, Path, Transforms } from 'slate';\r\nimport classnames from 'classnames';\r\nimport { css } from 'emotion';\r\nimport { ReactEditor, RenderElementProps } from 'slate-react';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport getPlainExcerpt from '../../get-plain-excerpt';\r\nimport type { MergeTags, MergeTag, CustomElement } from '../../types';\r\n\r\ninterface Props extends RenderElementProps {\r\n\tpath: Path;\r\n\tmergeTags: MergeTags;\r\n\teditor: ReactEditor;\r\n\tchildren: React.ReactNode;\r\n\telement: CustomElement;\r\n}\r\nconst EditorMergeTag: React.FC< Props > = ( {\r\n\tattributes,\r\n\teditor,\r\n\tchildren,\r\n\tpath,\r\n\telement,\r\n\tmergeTags,\r\n} ) => {\r\n\tconst { type, modifier } = element.data as MergeTag;\r\n\tconst [ node ] = Editor.node( editor, path );\r\n\r\n\tconst mergeTag = mergeTags.find(\r\n\t\t( a ) => a.type === type && a.modifier === modifier\r\n\t);\r\n\tconst mergeTagIcon = mergeTag?.icon ? mergeTag.icon : plus;\r\n\tconst renderedIcon = (\r\n\t\t<Icon\r\n\t\t\ticon={\r\n\t\t\t\t( ( mergeTagIcon as IconDescriptor )?.src as IconType )\r\n\t\t\t\t\t? ( ( mergeTagIcon as IconDescriptor )?.src as IconType )\r\n\t\t\t\t\t// @ts-expect-error\r\n\t\t\t\t\t: ( mergeTagIcon as Dashicon.Icon )\r\n\t\t\t}\r\n\t\t/>\r\n\t);\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( ! mergeTag ) {\r\n\t\t\teditor.apply( { type: 'remove_node', path, node } );\r\n\t\t\tTransforms.insertNodes(\r\n\t\t\t\teditor,\r\n\t\t\t\t{\r\n\t\t\t\t\ttext: `{{${ type }:${ modifier }}}`,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tat: path,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}\r\n\t}, [] );\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{ mergeTag && (\r\n\t\t\t\t<span\r\n\t\t\t\t\t{ ...attributes }\r\n\t\t\t\t\tcontentEditable={ false }\r\n\t\t\t\t\tclassName={ classnames(\r\n\t\t\t\t\t\t'rich-text-merge-tag__node-wrapper',\r\n\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\tcolor: ${ mergeTag?.color\r\n\t\t\t\t\t\t\t\t? mergeTag.color\r\n\t\t\t\t\t\t\t\t: '#bb426f' };\r\n\t\t\t\t\t\t\tbordercolor: ${ mergeTag?.color\r\n\t\t\t\t\t\t\t\t? mergeTag.color\r\n\t\t\t\t\t\t\t\t: '#bb426f' };\r\n\t\t\t\t\t\t\tfill: ${ mergeTag?.color\r\n\t\t\t\t\t\t\t\t? mergeTag.color\r\n\t\t\t\t\t\t\t\t: '#bb426f' };\r\n\t\t\t\t\t\t`\r\n\t\t\t\t\t) }\r\n\t\t\t\t>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={ classnames(\r\n\t\t\t\t\t\t\t'rich-text-merge-tag__background',\r\n\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\tbackground: ${ mergeTag?.color\r\n\t\t\t\t\t\t\t\t\t? mergeTag.color\r\n\t\t\t\t\t\t\t\t\t: '#bb426f' };\r\n\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t) }\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<span className=\"rich-text-merge-tag__icon-box\">\r\n\t\t\t\t\t\t{ renderedIcon }\r\n\t\t\t\t\t</span>\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName=\"rich-text-merge-tag__title\"\r\n\t\t\t\t\t\tdangerouslySetInnerHTML={ {\r\n\t\t\t\t\t\t\t__html: getPlainExcerpt( mergeTag.label ),\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tclassName=\"rich-text-merge-tag__delete\"\r\n\t\t\t\t\t\tonClick={ () => {\r\n\t\t\t\t\t\t\tsetTimeout( () => {\r\n\t\t\t\t\t\t\t\teditor.apply( {\r\n\t\t\t\t\t\t\t\t\ttype: 'remove_node',\r\n\t\t\t\t\t\t\t\t\tpath,\r\n\t\t\t\t\t\t\t\t\tnode,\r\n\t\t\t\t\t\t\t\t} );\r\n\t\t\t\t\t\t\t}, 0 );\r\n\t\t\t\t\t\t} }\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Icon icon={ close } />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t{ children }\r\n\t\t\t\t</span>\r\n\t\t\t) }\r\n\t\t</>\r\n\t);\r\n};\r\nexport default EditorMergeTag;\r\n"],"mappings":"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"}