{"version":3,"names":["useBlockTheme","HTMLParser","__experimentalUseFieldRenderContext","FieldRenderContextProvider","ErrMsg","useSelect","useDispatch","useEffect","useState","noop","size","css","classnames","zenScroll","GroupDisplay","_ref","id","innerBlocks","isTouchScreen","props","isErrMsgVisible","isActive","refIndex","setRefIndex","blockTypes","answers","isAnimating","select","getBlockTypes","getAnswers","refAssigned","theme","attributes","themeId","setIsFieldValid","setFieldValidationErr","setIsFieldAnswered","setIsFieldPending","setFieldPendingMsg","setFieldAnswer","firstInvalidBlock","forEach","block","index","isValid","defaultDuration","edgeOffset","myDiv","document","querySelector","myScroller","createScroller","target","getElementById","center","includes","name","setTimeout","inputRef","current","focus","createElement","Fragment","map","_block$attributes$lab","blockType","blockLabel","label","required","blockProps","next","val","value","setIsValid","setIsAnswered","setIsPending","setPendingMsg","setValidationErr","setVal","showNextBtn","showErrMsg","context","blockName","key","className","questionsColor","questionsLabelFont","fontSize","lg","fontLineHeight","sm","display","validationErr","message"],"sources":["@quillforms/blocklib-group-block/src/renderer/display.js"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport {\r\n\tuseBlockTheme,\r\n\tHTMLParser,\r\n\t__experimentalUseFieldRenderContext,\r\n\tFieldRenderContextProvider,\r\n\tErrMsg,\r\n} from '@quillforms/renderer-core';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\nimport { useEffect, useState } from 'react';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport { noop, size } from 'lodash';\r\nimport { css } from 'emotion';\r\nimport classnames from 'classnames';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport zenScroll from './zen-scroll';\r\n\r\nconst GroupDisplay = ( { id, innerBlocks, isTouchScreen, ...props } ) => {\r\n\tconst { isErrMsgVisible, isActive } = __experimentalUseFieldRenderContext();\r\n\t// By Default, the focus will be on the first item on the group.\r\n\tconst [ refIndex, setRefIndex ] = useState( 0 );\r\n\tconst { blockTypes, answers, isAnimating } = useSelect( ( select ) => {\r\n\t\treturn {\r\n\t\t\tisAnimating: select( 'quillForms/renderer-core' ).isAnimating(),\r\n\t\t\tblockTypes: select( 'quillForms/blocks' ).getBlockTypes(),\r\n\t\t\tanswers: select( 'quillForms/renderer-core' ).getAnswers(),\r\n\t\t};\r\n\t} );\r\n\tlet refAssigned = false;\r\n\r\n\tconst theme = useBlockTheme( props.attributes.themeId );\r\n\tconst {\r\n\t\tsetIsFieldValid,\r\n\t\tsetFieldValidationErr,\r\n\t\tsetIsFieldAnswered,\r\n\t\tsetIsFieldPending,\r\n\t\tsetFieldPendingMsg,\r\n\t\tsetFieldAnswer,\r\n\t} = useDispatch( 'quillForms/renderer-core' );\r\n\r\n\tuseEffect( () => {\r\n\t\tif ( isErrMsgVisible ) {\r\n\t\t\tlet firstInvalidBlock = null;\r\n\t\t\tif ( size( innerBlocks ) > 0 ) {\r\n\t\t\t\tinnerBlocks.forEach( ( block, index ) => {\r\n\t\t\t\t\tif ( ! answers[ block.id ]?.isValid ) {\r\n\t\t\t\t\t\tif ( ! firstInvalidBlock ) {\r\n\t\t\t\t\t\t\tsetRefIndex( index );\r\n\t\t\t\t\t\t\tfirstInvalidBlock = block;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tif ( firstInvalidBlock && isActive ) {\r\n\t\t\t\tconst defaultDuration = 500;\r\n\t\t\t\tconst edgeOffset = 30;\r\n\t\t\t\tconst myDiv = document.querySelector(\r\n\t\t\t\t\t`#block-${ id } .renderer-core-block-scroller`\r\n\t\t\t\t);\r\n\t\t\t\tconst myScroller = zenScroll.createScroller(\r\n\t\t\t\t\tmyDiv,\r\n\t\t\t\t\tdefaultDuration,\r\n\t\t\t\t\tedgeOffset\r\n\t\t\t\t);\r\n\t\t\t\tconst target = document.getElementById(\r\n\t\t\t\t\t`renderer-components-child-block-${ firstInvalidBlock.id }`\r\n\t\t\t\t);\r\n\t\t\t\tmyScroller.center( target );\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\t'short-text',\r\n\t\t\t\t\t\t'long-text',\r\n\t\t\t\t\t\t'email',\r\n\t\t\t\t\t\t'phone',\r\n\t\t\t\t\t\t'dropdown',\r\n\t\t\t\t\t\t'number',\r\n\t\t\t\t\t\t'date',\r\n\t\t\t\t\t\t'website',\r\n\t\t\t\t\t].includes( firstInvalidBlock.name ) &&\r\n\t\t\t\t\t! isAnimating &&\r\n\t\t\t\t\t! isTouchScreen\r\n\t\t\t\t) {\r\n\t\t\t\t\tsetTimeout( () => {\r\n\t\t\t\t\t\tprops?.inputRef?.current?.focus();\r\n\t\t\t\t\t}, 0 );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}, [ isErrMsgVisible, isActive, isAnimating ] );\r\n\treturn (\r\n\t\t<>\r\n\t\t\t{ size( innerBlocks ) > 0 &&\r\n\t\t\t\tinnerBlocks.map( ( block, index ) => {\r\n\t\t\t\t\tconst blockType = blockTypes[ block.name ];\r\n\t\t\t\t\tlet blockLabel = block?.attributes?.label ?? '';\r\n\t\t\t\t\tif ( block?.attributes?.required )\r\n\t\t\t\t\t\tblockLabel = blockLabel + ' *';\r\n\t\t\t\t\tconst blockProps = {\r\n\t\t\t\t\t\t...props,\r\n\t\t\t\t\t\tisTouchScreen,\r\n\t\t\t\t\t\tinputRef:\r\n\t\t\t\t\t\t\trefAssigned && refIndex !== index\r\n\t\t\t\t\t\t\t\t? null\r\n\t\t\t\t\t\t\t\t: props.inputRef,\r\n\t\t\t\t\t\tid: block.id,\r\n\t\t\t\t\t\tnext: noop,\r\n\t\t\t\t\t\tattributes: block.attributes,\r\n\t\t\t\t\t\tinnerBlocks,\r\n\t\t\t\t\t\tval: answers?.[ block.id ]?.value,\r\n\t\t\t\t\t\tsetIsValid: ( val ) => setIsFieldValid( block.id, val ),\r\n\t\t\t\t\t\tsetIsAnswered: ( val ) =>\r\n\t\t\t\t\t\t\tsetIsFieldAnswered( block.id, val ),\r\n\t\t\t\t\t\tsetIsPending: ( val ) =>\r\n\t\t\t\t\t\t\tsetIsFieldPending( block.id, val ),\r\n\t\t\t\t\t\tsetPendingMsg: ( val ) =>\r\n\t\t\t\t\t\t\tsetFieldPendingMsg( block.id, val ),\r\n\t\t\t\t\t\tsetValidationErr: ( val ) =>\r\n\t\t\t\t\t\t\tsetFieldValidationErr( block.id, val ),\r\n\t\t\t\t\t\tsetVal: ( val ) => setFieldAnswer( block.id, val ),\r\n\t\t\t\t\t\tshowNextBtn: noop,\r\n\t\t\t\t\t\tshowErrMsg: noop,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst context = {\r\n\t\t\t\t\t\tid,\r\n\t\t\t\t\t\tblockName: block.name,\r\n\t\t\t\t\t\tattributes: block.attributes,\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\trefAssigned = true;\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<FieldRenderContextProvider\r\n\t\t\t\t\t\t\tkey={ block.id }\r\n\t\t\t\t\t\t\tvalue={ context }\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={ css`\r\n\t\t\t\t\t\t\t\t\tmargin-bottom: 48px;\r\n\t\t\t\t\t\t\t\t\t&:last-child {\r\n\t\t\t\t\t\t\t\t\t\tmargin-bottom: 0;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t` }\r\n\t\t\t\t\t\t\t\tid={ `renderer-components-child-block-${ block?.id }` }\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tclassName={ classnames(\r\n\t\t\t\t\t\t\t\t\t\t'renderer-components-child-block-label',\r\n\t\t\t\t\t\t\t\t\t\tcss`\r\n\t\t\t\t\t\t\t\t\t\t\tcolor: ${ theme.questionsColor } !important;\r\n\t\t\t\t\t\t\t\t\t\t\tfont-family: ${ theme.questionsLabelFont } !important;\r\n\t\t\t\t\t\t\t\t\t\t\t@media ( min-width: 768px ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfont-size: ${ theme.fontSize\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.lg } !important;\r\n\t\t\t\t\t\t\t\t\t\t\t\tline-height: ${ theme\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.fontLineHeight\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.lg } !important;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t@media ( max-width: 767px ) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfont-size: ${ theme.fontSize\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.sm } !important;\r\n\t\t\t\t\t\t\t\t\t\t\t\tline-height: ${ theme\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.fontLineHeight\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.sm } !important;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tmargin-bottom: 12px !important;\r\n\t\t\t\t\t\t\t\t\t\t`\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<HTMLParser value={ blockLabel } />\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{ blockType?.display && (\r\n\t\t\t\t\t\t\t\t\t\t/* @ts-expect-error */\r\n\t\t\t\t\t\t\t\t\t\t<blockType.display { ...blockProps } />\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t{ isErrMsgVisible &&\r\n\t\t\t\t\t\t\t\t\tanswers?.[ block?.id ]?.validationErr && (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={ css`\r\n\t\t\t\t\t\t\t\t\t\t\t\tmargin-top: 20px;\r\n\t\t\t\t\t\t\t\t\t\t\t` }\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<ErrMsg\r\n\t\t\t\t\t\t\t\t\t\t\t\tmessage={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tanswers[ block.id ]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.validationErr\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t) }\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</FieldRenderContextProvider>\r\n\t\t\t\t\t);\r\n\t\t\t\t} ) }\r\n\t\t</>\r\n\t);\r\n};\r\nexport default GroupDisplay;\r\n"],"mappings":"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"}