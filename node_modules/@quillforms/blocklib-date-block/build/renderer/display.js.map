{"version":3,"names":["_rendererCore","require","_react","_data","_tinycolor","_interopRequireDefault","_reactTextMask","_dayjs","_customParseFormat","_emotion","_classnames","_createAutocorrectedDatePipe","DateOutput","props","id","attributes","setIsValid","isPreview","setIsAnswered","setValidationErr","showNextBtn","showErrMsg","val","setVal","setFooterDisplay","isTouchScreen","inputRef","isReviewing","format","separator","required","theme","useBlockTheme","themeId","messages","useMessages","answersColor","tinyColor","getPlaceholder","checkFieldValidation","value","dayJs","extend","CustomParseFormat","date","isValid","useEffect","changeHandler","e","target","autoCorrectedDatePipe","createAutoCorrectedDatePipe","toLowerCase","getMask","_element","createElement","default","onChange","ref","className","classnames","css","setAlpha","toString","placeholder","mask","pipe","length","onFocus","onBlur","autoComplete","_default","exports"],"sources":["@quillforms/blocklib-date-block/src/renderer/display.js"],"sourcesContent":["/**\r\n * QuillForms Dependencies\r\n */\r\nimport { useMessages, useBlockTheme } from '@quillforms/renderer-core';\r\n\r\n/**\r\n * WordPress Dependencies\r\n */\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useSelect } from '@wordpress/data';\r\n\r\n/**\r\n * External Dependencies\r\n */\r\nimport tinyColor from 'tinycolor2';\r\nimport MaskedInput from 'react-text-mask';\r\nimport dayJs from 'dayjs';\r\nimport CustomParseFormat from 'dayjs/plugin/customParseFormat';\r\nimport { css } from 'emotion';\r\nimport classnames from 'classnames';\r\n\r\n/**\r\n * Internal Dependencies\r\n */\r\nimport createAutoCorrectedDatePipe from './create-autocorrected-date-pipe';\r\n\r\nconst DateOutput = ( props ) => {\r\n\tconst {\r\n\t\tid,\r\n\t\tattributes,\r\n\t\tsetIsValid,\r\n\t\tisPreview,\r\n\t\tsetIsAnswered,\r\n\t\tsetValidationErr,\r\n\t\tshowNextBtn,\r\n\t\tshowErrMsg,\r\n\t\tval,\r\n\t\tsetVal,\r\n\t\tsetFooterDisplay,\r\n\t\tisTouchScreen,\r\n\t\tinputRef,\r\n\t\tisReviewing,\r\n\t} = props;\r\n\tconst { format, separator, required } = attributes;\r\n\tconst theme = useBlockTheme( attributes.themeId );\r\n\r\n\tconst messages = useMessages();\r\n\tconst answersColor = tinyColor( theme.answersColor );\r\n\r\n\tconst getPlaceholder = () => {\r\n\t\tif ( format === 'MMDDYYYY' ) {\r\n\t\t\treturn 'MM' + separator + 'DD' + separator + 'YYYY';\r\n\t\t} else if ( format === 'DDMMYYYY' ) {\r\n\t\t\treturn 'DD' + separator + 'MM' + separator + 'YYYY';\r\n\t\t} else if ( format === 'YYYYMMDD' ) {\r\n\t\t\treturn 'YYYY' + separator + 'MM' + separator + 'DD';\r\n\t\t}\r\n\t};\r\n\r\n\tconst checkFieldValidation = ( value ) => {\r\n\t\tdayJs.extend( CustomParseFormat );\r\n\t\tconst date = dayJs( value, getPlaceholder(), true );\r\n\t\tif ( required === true && ( ! value || value === '' ) ) {\r\n\t\t\tsetIsValid( false );\r\n\t\t\tsetValidationErr( messages[ 'label.errorAlert.required' ] );\r\n\t\t} else if ( ! date.isValid() && value ) {\r\n\t\t\tsetIsValid( false );\r\n\t\t\tsetValidationErr( messages[ 'label.errorAlert.date' ] );\r\n\t\t} else {\r\n\t\t\tsetIsValid( true );\r\n\t\t\tsetValidationErr( null );\r\n\t\t}\r\n\t};\r\n\r\n\tuseEffect( () => {\r\n\t\t// if change in required flag and is in preview mode, check validation\r\n\t\t// Note, that this effect will also be called on mount, that's why we check if isReviewing = false\r\n\t\t// because we want to display errors coming from server.\r\n\t\tif ( isPreview || ! isReviewing ) checkFieldValidation( val );\r\n\t}, [ attributes ] );\r\n\r\n\tconst changeHandler = ( e ) => {\r\n\t\tconst value = e.target.value;\r\n\t\tsetVal( value );\r\n\t\tshowErrMsg( false );\r\n\t\tcheckFieldValidation( value );\r\n\r\n\t\tif ( value !== '' ) {\r\n\t\t\tsetIsAnswered( true );\r\n\t\t\tshowNextBtn( true );\r\n\t\t} else {\r\n\t\t\tsetIsAnswered( false );\r\n\t\t}\r\n\t};\r\n\r\n\tconst autoCorrectedDatePipe = createAutoCorrectedDatePipe(\r\n\t\tgetPlaceholder()?.toLowerCase()\r\n\t);\r\n\r\n\tconst getMask = () => {\r\n\t\tif ( format === 'YYYYMMDD' ) {\r\n\t\t\treturn [\r\n\t\t\t\t/\\d/,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\tseparator,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\tseparator,\r\n\t\t\t\t/\\d/,\r\n\t\t\t\t/\\d/,\r\n\t\t\t];\r\n\t\t}\r\n\t\treturn [\r\n\t\t\t/\\d/,\r\n\t\t\t/\\d/,\r\n\t\t\tseparator,\r\n\t\t\t/\\d/,\r\n\t\t\t/\\d/,\r\n\t\t\tseparator,\r\n\t\t\t/\\d/,\r\n\t\t\t/\\d/,\r\n\t\t\t/\\d/,\r\n\t\t\t/\\d/,\r\n\t\t];\r\n\t};\r\n\r\n\treturn (\r\n\t\t<MaskedInput\r\n\t\t\tonChange={ changeHandler }\r\n\t\t\tref={ inputRef }\r\n\t\t\tclassName={ classnames(\r\n\t\t\t\tcss`\r\n\t\t\t\t\t& {\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t\tborder: none;\r\n\t\t\t\t\t\toutline: none;\r\n\t\t\t\t\t\tborder: none !important;\r\n\t\t\t\t\t\tborder-radius: 0 !important;\r\n\t\t\t\t\t\tpadding-bottom: 8px;\r\n\t\t\t\t\t\tbackground: transparent;\r\n\t\t\t\t\t\ttransition: box-shadow 0.1s ease-out 0s;\r\n\t\t\t\t\t\tbox-shadow: ${ answersColor.setAlpha( 0.3 ).toString() }\r\n\t\t\t\t\t\t\t0px 1px !important;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&::placeholder {\r\n\t\t\t\t\t\topacity: 0.3;\r\n\t\t\t\t\t\t/* Chrome, Firefox, Opera, Safari 10.1+ */\r\n\t\t\t\t\t\tcolor: ${ theme.answersColor };\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:-ms-input-placeholder {\r\n\t\t\t\t\t\topacity: 0.3;\r\n\t\t\t\t\t\t/* Internet Explorer 10-11 */\r\n\t\t\t\t\t\tcolor: ${ theme.answersColor };\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&::-ms-input-placeholder {\r\n\t\t\t\t\t\topacity: 0.3;\r\n\t\t\t\t\t\t/* Microsoft Edge */\r\n\t\t\t\t\t\tcolor: ${ theme.answersColor };\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t&:focus {\r\n\t\t\t\t\t\tbox-shadow: ${ answersColor.setAlpha( 1 ).toString() }\r\n\t\t\t\t\t\t\t0px 2px !important;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tcolor: ${ theme.answersColor };\r\n\t\t\t\t`\r\n\t\t\t) }\r\n\t\t\tplaceholder={ getPlaceholder() }\r\n\t\t\tmask={ getMask() }\r\n\t\t\tpipe={ autoCorrectedDatePipe }\r\n\t\t\tvalue={ val && val.length > 0 ? val : '' }\r\n\t\t\tonFocus={ () => {\r\n\t\t\t\tif ( isTouchScreen ) {\r\n\t\t\t\t\tsetFooterDisplay( false );\r\n\t\t\t\t}\r\n\t\t\t} }\r\n\t\t\tonBlur={ () => {\r\n\t\t\t\tif ( isTouchScreen ) {\r\n\t\t\t\t\tsetFooterDisplay( true );\r\n\t\t\t\t}\r\n\t\t\t} }\r\n\t\t\tautoComplete=\"off\"\r\n\t\t/>\r\n\t);\r\n};\r\nexport default DateOutput;\r\n"],"mappings":"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"}