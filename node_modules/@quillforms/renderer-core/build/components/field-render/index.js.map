{"version":3,"names":["_element","require","_data","_context","_fieldWrapper","_interopRequireDefault","FieldRender","memo","_ref","id","isActive","isLastField","shouldBeRendered","isCurrentBlockSafeToSwipe","next","isSubmitBtnVisible","showNextBtn","useState","isErrMsgVisible","showErrMsg","isReviewing","isValid","block","firstInvalidFieldId","lastFieldId","useSelect","select","walkPath","getWalkPath","isValidField","getBlockById","getFirstInvalidFieldId","length","goToBlock","setIsCurrentBlockSafeToSwipe","useDispatch","useEffect","name","attributes","innerBlocks","context","blockName","createElement","FieldRenderContextProvider","value","default","_default","exports"],"sources":["@quillforms/renderer-core/src/components/field-render/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect, memo } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tFieldRenderContextProvider,\r\n\t__experimentalUseFieldRenderContext,\r\n} from './context';\r\nimport FieldWrapper from '../field-wrapper';\r\n\r\nexport { __experimentalUseFieldRenderContext };\r\n\r\ninterface Props {\r\n\tid: string;\r\n\tisActive: boolean;\r\n\tshouldBeRendered: boolean;\r\n\tisLastField: boolean;\r\n\tisCurrentBlockSafeToSwipe: boolean;\r\n\tnext: Function;\r\n}\r\n\r\nconst FieldRender: React.FC< Props > = memo(\r\n\t( {\r\n\t\tid,\r\n\t\tisActive,\r\n\t\tisLastField,\r\n\t\tshouldBeRendered,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t\tnext,\r\n\t} ) => {\r\n\t\tconst [ isSubmitBtnVisible, showNextBtn ] = useState< boolean >( true );\r\n\t\tconst [ isErrMsgVisible, showErrMsg ] = useState< boolean >( false );\r\n\r\n\t\tconst {\r\n\t\t\tisReviewing,\r\n\t\t\tisValid,\r\n\t\t\tblock,\r\n\t\t\tfirstInvalidFieldId,\r\n\t\t\tlastFieldId,\r\n\t\t} = useSelect( ( select ) => {\r\n\t\t\tconst walkPath = select( 'quillForms/renderer-core' ).getWalkPath();\r\n\t\t\treturn {\r\n\t\t\t\tisReviewing: select( 'quillForms/renderer-core' ).isReviewing(),\r\n\t\t\t\tisValid: select( 'quillForms/renderer-core' ).isValidField(\r\n\t\t\t\t\tid\r\n\t\t\t\t),\r\n\t\t\t\tblock: select( 'quillForms/renderer-core' ).getBlockById( id ),\r\n\t\t\t\tfirstInvalidFieldId: select(\r\n\t\t\t\t\t'quillForms/renderer-core'\r\n\t\t\t\t).getFirstInvalidFieldId(),\r\n\t\t\t\tlastFieldId: walkPath[ walkPath.length - 1 ].id,\r\n\t\t\t};\r\n\t\t} );\r\n\r\n\t\tconst { goToBlock, setIsCurrentBlockSafeToSwipe } = useDispatch(\r\n\t\t\t'quillForms/renderer-core'\r\n\t\t);\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( isActive && ! isReviewing && ! isErrMsgVisible ) {\r\n\t\t\t\tshowErrMsg( false );\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe( true );\r\n\t\t\t}\r\n\t\t}, [ isActive, isErrMsgVisible, isReviewing ] );\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( ! isCurrentBlockSafeToSwipe ) {\r\n\t\t\t\tshowErrMsg( true );\r\n\t\t\t}\r\n\t\t}, [ isCurrentBlockSafeToSwipe ] );\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( isReviewing && ! isValid ) {\r\n\t\t\t\tshowErrMsg( true );\r\n\t\t\t}\r\n\t\t}, [ isReviewing, isValid ] );\r\n\r\n\t\tif ( ! block ) return null;\r\n\t\t//console.log( block );\r\n\t\tconst { name, attributes, innerBlocks } = block;\r\n\r\n\t\tconst context = {\r\n\t\t\tid,\r\n\t\t\tblockName: name,\r\n\t\t\tattributes,\r\n\t\t\tinnerBlocks,\r\n\t\t\tisActive,\r\n\t\t\tshouldBeRendered,\r\n\t\t\tisErrMsgVisible,\r\n\t\t\tshowErrMsg,\r\n\t\t\tisSubmitBtnVisible,\r\n\t\t\tshowNextBtn,\r\n\t\t\tnext: () => {\r\n\t\t\t\tif ( ! isReviewing ) {\r\n\t\t\t\t\tnext();\r\n\t\t\t\t} else if ( firstInvalidFieldId ) {\r\n\t\t\t\t\tgoToBlock( firstInvalidFieldId );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgoToBlock( lastFieldId );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisLastField,\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<FieldRenderContextProvider value={ context }>\r\n\t\t\t\t<FieldWrapper />\r\n\t\t\t</FieldRenderContextProvider>\r\n\t\t);\r\n\t}\r\n);\r\n\r\nexport default FieldRender;\r\n"],"mappings":"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"}