{"version":3,"names":["useState","useEffect","memo","useSelect","useDispatch","FieldRenderContextProvider","__experimentalUseFieldRenderContext","FieldWrapper","FieldRender","_ref","id","isActive","isLastField","shouldBeRendered","isCurrentBlockSafeToSwipe","next","isSubmitBtnVisible","showNextBtn","isErrMsgVisible","showErrMsg","isReviewing","isValid","block","firstInvalidFieldId","lastFieldId","select","walkPath","getWalkPath","isValidField","getBlockById","getFirstInvalidFieldId","length","goToBlock","setIsCurrentBlockSafeToSwipe","name","attributes","innerBlocks","context","blockName","createElement","value"],"sources":["@quillforms/renderer-core/src/components/field-render/index.tsx"],"sourcesContent":["/**\r\n * WordPress dependencies\r\n */\r\nimport { useState, useEffect, memo } from '@wordpress/element';\r\nimport { useSelect, useDispatch } from '@wordpress/data';\r\n/**\r\n * Internal dependencies\r\n */\r\nimport {\r\n\tFieldRenderContextProvider,\r\n\t__experimentalUseFieldRenderContext,\r\n} from './context';\r\nimport FieldWrapper from '../field-wrapper';\r\n\r\nexport { __experimentalUseFieldRenderContext };\r\n\r\ninterface Props {\r\n\tid: string;\r\n\tisActive: boolean;\r\n\tshouldBeRendered: boolean;\r\n\tisLastField: boolean;\r\n\tisCurrentBlockSafeToSwipe: boolean;\r\n\tnext: Function;\r\n}\r\n\r\nconst FieldRender: React.FC< Props > = memo(\r\n\t( {\r\n\t\tid,\r\n\t\tisActive,\r\n\t\tisLastField,\r\n\t\tshouldBeRendered,\r\n\t\tisCurrentBlockSafeToSwipe,\r\n\t\tnext,\r\n\t} ) => {\r\n\t\tconst [ isSubmitBtnVisible, showNextBtn ] = useState< boolean >( true );\r\n\t\tconst [ isErrMsgVisible, showErrMsg ] = useState< boolean >( false );\r\n\r\n\t\tconst {\r\n\t\t\tisReviewing,\r\n\t\t\tisValid,\r\n\t\t\tblock,\r\n\t\t\tfirstInvalidFieldId,\r\n\t\t\tlastFieldId,\r\n\t\t} = useSelect( ( select ) => {\r\n\t\t\tconst walkPath = select( 'quillForms/renderer-core' ).getWalkPath();\r\n\t\t\treturn {\r\n\t\t\t\tisReviewing: select( 'quillForms/renderer-core' ).isReviewing(),\r\n\t\t\t\tisValid: select( 'quillForms/renderer-core' ).isValidField(\r\n\t\t\t\t\tid\r\n\t\t\t\t),\r\n\t\t\t\tblock: select( 'quillForms/renderer-core' ).getBlockById( id ),\r\n\t\t\t\tfirstInvalidFieldId: select(\r\n\t\t\t\t\t'quillForms/renderer-core'\r\n\t\t\t\t).getFirstInvalidFieldId(),\r\n\t\t\t\tlastFieldId: walkPath[ walkPath.length - 1 ].id,\r\n\t\t\t};\r\n\t\t} );\r\n\r\n\t\tconst { goToBlock, setIsCurrentBlockSafeToSwipe } = useDispatch(\r\n\t\t\t'quillForms/renderer-core'\r\n\t\t);\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( isActive && ! isReviewing && ! isErrMsgVisible ) {\r\n\t\t\t\tshowErrMsg( false );\r\n\t\t\t\tsetIsCurrentBlockSafeToSwipe( true );\r\n\t\t\t}\r\n\t\t}, [ isActive, isErrMsgVisible, isReviewing ] );\r\n\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( ! isCurrentBlockSafeToSwipe ) {\r\n\t\t\t\tshowErrMsg( true );\r\n\t\t\t}\r\n\t\t}, [ isCurrentBlockSafeToSwipe ] );\r\n\t\tuseEffect( () => {\r\n\t\t\tif ( isReviewing && ! isValid ) {\r\n\t\t\t\tshowErrMsg( true );\r\n\t\t\t}\r\n\t\t}, [ isReviewing, isValid ] );\r\n\r\n\t\tif ( ! block ) return null;\r\n\t\t//console.log( block );\r\n\t\tconst { name, attributes, innerBlocks } = block;\r\n\r\n\t\tconst context = {\r\n\t\t\tid,\r\n\t\t\tblockName: name,\r\n\t\t\tattributes,\r\n\t\t\tinnerBlocks,\r\n\t\t\tisActive,\r\n\t\t\tshouldBeRendered,\r\n\t\t\tisErrMsgVisible,\r\n\t\t\tshowErrMsg,\r\n\t\t\tisSubmitBtnVisible,\r\n\t\t\tshowNextBtn,\r\n\t\t\tnext: () => {\r\n\t\t\t\tif ( ! isReviewing ) {\r\n\t\t\t\t\tnext();\r\n\t\t\t\t} else if ( firstInvalidFieldId ) {\r\n\t\t\t\t\tgoToBlock( firstInvalidFieldId );\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgoToBlock( lastFieldId );\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisLastField,\r\n\t\t};\r\n\t\treturn (\r\n\t\t\t<FieldRenderContextProvider value={ context }>\r\n\t\t\t\t<FieldWrapper />\r\n\t\t\t</FieldRenderContextProvider>\r\n\t\t);\r\n\t}\r\n);\r\n\r\nexport default FieldRender;\r\n"],"mappings":"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"}